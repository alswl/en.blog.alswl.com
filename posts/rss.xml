<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Posts on Log4D</title>
    <link>https://en.blog.alswl.com/posts/</link>
    <description>Recent content in Posts on Log4D</description>
    <generator>Hugo -- 0.148.2</generator>
    <language>en-us</language>
    <lastBuildDate>Sat, 11 Jan 2025 13:52:48 +0800</lastBuildDate>
    <atom:link href="https://en.blog.alswl.com/posts/rss.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>2024 Year in Review</title>
      <link>https://en.blog.alswl.com/2025/01/2024-review/</link>
      <pubDate>Sat, 11 Jan 2025 13:52:48 +0800</pubDate>
      <guid>https://en.blog.alswl.com/2025/01/2024-review/</guid>
      <description>&lt;h2 id=&#34;life---show-me-your-photos&#34;&gt;Life - Show me your photos&lt;/h2&gt;
&lt;p&gt;The Earth keeps orbiting the sun; as time passes, we brush past life, carrying memories of the past and stepping into the unknown ahead.&lt;/p&gt;
&lt;p&gt;Last year, I set myself a goal about life: &lt;strong&gt;family and companionship&lt;/strong&gt;. One part was ‚Äúquality time together,‚Äù and another was ‚Äúlearning to take pleasing snapshots.‚Äù On every trip, I wanted to capture the play of light and shadow and the warmth of the moment in photos. This year, that theme became ‚Äî &lt;strong&gt;Show me your photos&lt;/strong&gt;.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<h2 id="life---show-me-your-photos">Life - Show me your photos</h2>
<p>The Earth keeps orbiting the sun; as time passes, we brush past life, carrying memories of the past and stepping into the unknown ahead.</p>
<p>Last year, I set myself a goal about life: <strong>family and companionship</strong>. One part was ‚Äúquality time together,‚Äù and another was ‚Äúlearning to take pleasing snapshots.‚Äù On every trip, I wanted to capture the play of light and shadow and the warmth of the moment in photos. This year, that theme became ‚Äî <strong>Show me your photos</strong>.</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202501/9C5FC713-AE62-40DF-9346-9959BFB73460_1_105_c.jpeg" alt="Lighthouse by the sea at the start of 2024"  />


</p>
<p><small>Start of 2024, lighthouse by the sea.</small></p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202501/2D5E7F7F-D848-431E-BCA8-35F66E2B2A42_1_105_c.jpeg" alt="Dragon lantern in early spring"  />


</p>
<p><small>Chilly early spring, out for a stroll with a festive dragon lantern.</small></p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202501/52514E49-D7FA-435E-9D2C-6F63ADDC7BE3_1_105_c.jpeg" alt="From Chaozhou to Quanzhou"  />


</p>
<p><small>From the bustle of Chaoshan to religiously diverse Quanzhou.</small></p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202501/0626DA1D-13EB-4E84-BBD5-F1E917A43F1E_1_105_c.jpeg" alt="Kiyomizu-dera, Kyoto"  />


</p>
<p><small>Kiyomizu-dera in Kyoto; the kid made a Zen-like wish: I hope Buddha is happy every day.</small></p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202501/2F9CE840-12AD-4530-94BA-4F6547432939_1_105_c.jpeg" alt="Terraced fields in Lishui, South Zhejiang"  />


</p>
<p><small>Lishui, terraced fields in South Zhejiang.</small></p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202501/8EF8406E-C56F-4520-A486-F253792E6A4E_1_105_c.jpeg" alt="Hukou Falls"  />


</p>
<p><small>Hukou Falls, red flags and the roaring Yellow River.</small></p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202501/20CE5D94-12A4-4BE6-B326-9130FC654C7B_1_102_o.jpeg" alt="Disney year-end fireworks"  />


</p>
<p><small>Disney, year-end fireworks.</small></p>
<h2 id="work---building-the-foundation">Work - Building the foundation</h2>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202501/D2C3997C-CDA6-4518-90B4-2214E7F79449_1_105_c.jpeg" alt="Gatling-style fireworks on the grassland"  />


</p>
<p><small>Gatling-style fireworks on the grassland.</small></p>
<p>This year I shifted from explorer to someone driving systematic evolution in an organized way. Early in the year I even had a sense that the skeleton of the ‚Äúbuilding‚Äù was in place‚Äînext would be steady construction to keep the flywheel moving, and I started to explore new directions in AIGC, hoping to find a breakthrough there.</p>
<p>Reality soon delivered a sharp wake-up call. As AIGC grew explosively, we witnessed history while facing a huge surge in compute demand. Wave after wave of pressure landed; new demands and old debt tangled together and put massive strain on infrastructure delivery. Several core colleagues in this space left within a few months. People left, but the work had to go on. From June I was on the front line with a small team.</p>
<p>There were times I felt close to breaking. I wrote a series of posts about ‚Äú<a href="https://x.com/alswl/status/1791341868439195945">death march</a>.‚Äù</p>
<p>Pain often leads to reflection, especially when things feel unbearable‚Äîit can sharpen insight. When you‚Äôre near the bottom, the rebound can begin. At some point I understood: the problems are temporary; what we‚Äôre really building is the inner capacity to face difficulty with clarity and to see problems squarely.</p>
<p>No need to fear others‚Äô judgment or to resent the messiness of collaboration. The situation and the problems are there; the solutions aren‚Äôt mysterious‚Äîthe key is to face them. With a calm mind and realistic expectations, we can see the roots of problems in the chaos, spot opportunity in difficulty, and glimpse the future in the present. Real strength is drawing wisdom from each challenge and courage from each setback.</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202501/2DF11EEA-9872-4B84-8723-AFF155E951B6_1_105_c.jpeg" alt="Near Meiren Tui, Suzhou"  />


</p>
<p><small>Near Meiren Tui, Suzhou.</small></p>
<h2 id="side-projects---better-than-nothing">Side projects - Better than nothing</h2>
<p>Work took almost all my time this year, so I had little energy left for side projects. Only two small ones.</p>
<p><a href="https://github.com/alswl/dbml-editor">dbml-editor</a>, a free online DBML editor.</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202501/dbml-editor.png" alt="dbml-editor screenshot"  />


</p>
<ul>
<li>DBML syntax checking and feedback. DBML is a language for describing relational database schemas; it‚Äôs declarative and often easier to read than SQL.</li>
<li>Responsive web layout</li>
<li>WYSIWYG</li>
<li>Import/export SQL</li>
</ul>
<p><a href="https://github.com/alswl/random-apple-music">random-apple-music</a> is a playlist that randomly picks from Douban Music Top 250 and lets you jump to Apple Music with one click.</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202501/random-apple-music.png" alt="random-apple-music screenshot"  />


</p>
<ul>
<li>üéµ Music lovers, discover new gems!</li>
<li>üçè Random picks from Douban Music Top 250, one tap to Apple Music!</li>
<li>üéß Endless music possibilities!</li>
</ul>
<p>My most popular posts on X (Twitter) this year:</p>
<ul>
<li>169k <a href="https://x.com/alswl/status/1742558249260286368">English learning tips</a></li>
<li>83k <a href="https://x.com/alswl/status/1781907605239238759">Distributed systems engineering practice</a></li>
<li>75k <a href="https://x.com/alswl/status/1748941468277100617">Proxy protocol conversion with gost</a></li>
<li>56k <a href="https://x.com/alswl/status/1791341868439195945">Death march</a></li>
<li>52k <a href="https://x.com/alswl/status/1754053512877781012">Endoflife info</a></li>
<li>46k <a href="https://x.com/alswl/status/1769195102126153880">Red Alert on Steam</a></li>
<li>44k <a href="https://x.com/alswl/status/1753269221872771463">Git rebase merge tips</a></li>
<li>43k <a href="https://x.com/alswl/status/1780990211885023699">dbdiagram.io</a></li>
<li>40k <a href="https://x.com/alswl/status/1754759307172962496">cors.sh</a></li>
<li>38k <a href="https://x.com/alswl/status/1748941468277100617">24 questions every year</a></li>
<li>37k <a href="https://x.com/alswl/status/1764671403872383348">How to expand work impact</a></li>
<li>21k <a href="https://x.com/alswl/status/1791747889628430632">How to write good documentation</a></li>
</ul>
<h2 id="reading---a-pleasant-surprise">Reading - A pleasant surprise</h2>
<p>After getting a Boox e-reader this year, my reading volume jumped. I read 34 books in total, mostly nonfiction; 10 of them I rated five stars. With Kindle gone from China, WeChat Read became the main option. I don‚Äôt own the books, but the cost dropped a lot‚Äîuploading two books per month is enough. I also changed my view on audiobooks: I used to look down on them, but now I find listening while doing chores or commuting a good way to use my brain.</p>
<p><a href="https://book.douban.com/subject/26925171/">The Ming Dynasty 1566 (Douban)</a></p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202501/s29249996.jpg" alt="The Ming Dynasty 1566"  />


</p>
<p>Brilliant‚Äîthe actors‚Äô lines could almost be used as-is with no changes.</p>
<p><a href="https://book.douban.com/subject/36328704/">Too Bad, Old Tai Bai (Douban)</a></p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202501/s34544956.jpg" alt="Too Bad, Old Tai Bai"  />


</p>
<p>Witty and fun.</p>
<p><a href="https://book.douban.com/subject/26874220/">Huawei Internal Training (Douban)</a></p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202501/s29042375.jpg" alt="Huawei Internal Training"  />


</p>
<p>Huawei‚Äôs management philosophy and Alibaba‚Äôs ‚ÄúSix Meridians‚Äù share a focus on customers and goals. Though the ideas are similar, Huawei‚Äôs manual lacks case studies, and culture is often shaped by resolving real conflicts. The book stresses direction, professionalism, execution, and self-criticism‚Äîall important for growth. Huawei started in network equipment and became a diversified tech giant; its hardware DNA may help it stay steady. Alibaba and other internet companies have had a rougher time in the market lately.</p>
<p><a href="https://book.douban.com/subject/35328607/">Origin (Douban)</a></p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202501/s33804010.jpg" alt="Origin"  />


</p>
<p>Highly recommended. It covers the origin of the universe and the birth and evolution of life. It reminded me of a documentary I saw as a kid, <em>The Universe and Us</em>. I‚Äôd like to dig into the terminology someday‚Äîit spans macro and micro physics, chemistry, and biology.</p>
<p><a href="https://book.douban.com/subject/36449803/">This Is ChatGPT (Douban)</a></p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202501/s34566250.jpg" alt="This Is ChatGPT"  />


</p>
<p>A master in the field explains the essentials to newcomers. Reading papers was dry and the details didn‚Äôt connect; this book helped tie it together. The Transformer attention mechanism isn‚Äôt covered much, but commenters added more in the reviews.</p>
<p><a href="https://book.douban.com/subject/30270959/">Deep Learning from Scratch (Douban)</a></p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202501/s29815955.jpg" alt="Deep Learning from Scratch"  />


</p>
<p>A solid intro to deep learning. Unlike ‚Äúhow to use‚Äù books, this one focuses on ‚Äúhow to build‚Äù‚Äîit implements a simple framework in Python and applies it to handwritten digit recognition. It walks through what each layer does, with the math and intuition. Though it‚Äôs been out for almost five years, the content still holds; the outlook at the end, including object recognition and RNN (the basis of GPT), is very relevant today.</p>
<p><a href="https://book.douban.com/subject/35876121/">The Almanack of Naval Ravikant (Douban)</a></p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202501/s34241855.jpg" alt="The Almanack of Naval Ravikant"  />


</p>
<p>The book is like a mental massage‚Äîa short lift, but you still have to act. When I‚Äôm stuck, I need that kind of relief. Reading the chapter on emotional regulation reminded me of a recent work conflict where I lost my temper. I knew the principles; maybe if I‚Äôd read Naval‚Äôs chapter earlier I could have stayed rational. Good books deserve rereading. The chapters on wealth and judgment hit hardest: do high-leverage work to build wealth; use stable mental models; learn math, especially probability and statistics.</p>
<p><a href="https://book.douban.com/subject/30175059/">Lee Kuan Yew: One Man‚Äôs View of the World (Douban)</a></p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202501/s33687518.jpg" alt="Lee Kuan Yew: One Man&rsquo;s View of the World"  />


</p>
<p>As a statesman, having the will, the drive, depth of thought, and a broad view free from dogma already puts him in the top tier. What‚Äôs rare is Lee Kuan Yew‚Äôs candor‚Äîlikely tied to Singapore‚Äôs size and its people. The comments on this book are dense; other readers added many angles (and what happened afterward).</p>
<p><a href="https://book.douban.com/subject/26171466/">The Hard Road (Douban)</a></p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202501/s33986279.jpg" alt="The Hard Road"  />


</p>
<p>A remarkable book. The author, a Party history researcher, discusses at length the political and economic line disputes from the founding of the PRC to the present. He doesn‚Äôt shy away from describing Mao‚ÄîI saw someone in a hurry to reach communism in one go and leave a classless society, launching movement after movement. Deng‚Äôs course correction and reform and opening up followed. Moving to think of a generation‚Äôs sacrifice‚Äîeach number a broken family. I hope for less grand narrative and more attention to daily life and people‚Äôs welfare.</p>
<p><a href="https://book.douban.com/subject/35317149/">At the Bend of the Gorge (Douban)</a></p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202501/s33945521.jpg" alt="At the Bend of the Gorge"  />


</p>
<p>From obscurity to the spotlight. The writing feels sincere and plain; I was moved to tears more than once by Chen Xingjia‚Äôs integrity, warmth, and vitality. Some say it‚Äôs performance; I‚Äôd rather believe in that sincerity and hold to what I choose to believe.</p>
<p><a href="https://book.douban.com/subject/36480389/">The Unvanquished (Douban)</a></p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202501/s34996310.jpg" alt="The Unvanquished"  />


</p>
<p><em>The Unvanquished</em>‚Äîa domestic sci-fi collection that surprised me. Mo Xiong‚Äôs style has a push toward the edge of the universe; he takes a fragment of space opera and brings it close to the reader. ‚ÄúThe Carrier Pigeon‚Äù blends soft and hard SF, with reason and emotion bound by the speed of light. ‚ÄúWhite Ghost‚Äù reads like a power fantasy. ‚ÄúThe Unvanquished‚Äù reminded me of the Weeping Angels in <em>Doctor Who</em>‚Äîa kind of hunt across timelines. Both the hunt and the way out are clever and unexpected.</p>
<h2 id="last">Last</h2>
<p>Here‚Äôs to a new year that is both lively and quiet, deep and simple.</p>
]]></content:encoded>
    </item>
    <item>
      <title>2023 Year in Review</title>
      <link>https://en.blog.alswl.com/2024/01/2023-review/</link>
      <pubDate>Mon, 08 Jan 2024 23:38:59 +0800</pubDate>
      <guid>https://en.blog.alswl.com/2024/01/2023-review/</guid>
      <description>&lt;p&gt;




&lt;img loading=&#34;lazy&#34; src=&#34;https://en.blog.alswl.com/images/202401/flower.png&#34; alt=&#34;flower&#34;  /&gt;


&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Time has made its choice; too many feelings cannot be summed up in a few words.&lt;/p&gt;&lt;/blockquote&gt;
&lt;h2 id=&#34;life--companionship-and-growth&#34;&gt;Life ‚Äî Companionship and Growth&lt;/h2&gt;
&lt;p&gt;




&lt;img loading=&#34;lazy&#34; src=&#34;https://en.blog.alswl.com/images/202401/boy.png&#34; alt=&#34;boy&#34;  /&gt;


&lt;/p&gt;
&lt;p&gt;This is my 35th year. I am familiar with playing multiple roles: father, husband, son‚Äîeach moment woven with companionship and growth.
The pace of life seems rushed, but I try to keep a young heart and a curiosity and passion for the world.&lt;/p&gt;
&lt;p&gt;Most of my time is taken by daily life; only on the subway and at the dinner table do I feel in control of my time.
Fortunately, I don‚Äôt feel tired or dull. Instead, I‚Äôve gradually adapted to this change of identity.
Perhaps it‚Äôs in these mundane routines that I‚Äôve found a rhythm of life‚Äîa calm and warm state.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202401/flower.png" alt="flower"  />


</p>
<blockquote>
<p>Time has made its choice; too many feelings cannot be summed up in a few words.</p></blockquote>
<h2 id="life--companionship-and-growth">Life ‚Äî Companionship and Growth</h2>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202401/boy.png" alt="boy"  />


</p>
<p>This is my 35th year. I am familiar with playing multiple roles: father, husband, son‚Äîeach moment woven with companionship and growth.
The pace of life seems rushed, but I try to keep a young heart and a curiosity and passion for the world.</p>
<p>Most of my time is taken by daily life; only on the subway and at the dinner table do I feel in control of my time.
Fortunately, I don‚Äôt feel tired or dull. Instead, I‚Äôve gradually adapted to this change of identity.
Perhaps it‚Äôs in these mundane routines that I‚Äôve found a rhythm of life‚Äîa calm and warm state.</p>
<p>This year we traveled to Beijing, Hanzhong, Xi‚Äôan, Chun‚Äôan, Changsha, Zhangjiajie, and Taizhou.
With the new year approaching, we‚Äôre preparing to get a passport for our child and go out to see the world.</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202401/tower.png" alt="tower"  />


</p>
<p>While accompanying our child‚Äîjoining nature courses, visiting exhibitions‚ÄîI‚Äôve found that we‚Äôre growing together without realizing it.
On another front, I borrowed two cameras from my mother and finally decided to learn photography properly.
I sold my Canon 6D and kept the lightweight APS-C Sony a6500.
I hope photography becomes a way to express myself and document life; each photo is a frozen moment and a witness to time.</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202401/five.png" alt="five"  />


</p>
<p>In the world of games, I seem to have hit a period of ‚Äúgaming impotence.‚Äù Almost every game I buy becomes boring after an hour.
Maybe real life is the most compelling game of all.</p>
<p>Perhaps life is an ever-changing adventure. On the stage of time, we play various roles and tell our own stories.</p>
<h2 id="work--getting-better">Work ‚Äî Getting Better</h2>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202401/balloon.png" alt="balloon"  />


</p>
<p>Work has been under great pressure and tension, and I‚Äôve become more of an explorer.
Over the past two years, I‚Äôve kept pushing projects to launch; about half of the new products from our department were my responsibility. I like this domain and really want to do it well.</p>
<p>Sometimes, though, I feel a bit like a cleaner the company hired‚Äîin a ‚Äúscattered, multiple, hanging‚Äù state.
In a complex environment, solving problems is never easy. While tidying up messes, new mess is still being generated, and the cleanup never ends.
In reality, attention keeps shifting to new things (like AIGC), and existing problems are often ignored.</p>
<p>The broader company environment keeps changing. Some old colleagues have left, and our larger org has gone through changes too.
From a risk-oriented re-org to a compute-oriented infrastructure team. I see this as a good sign:
AI Infra will continue to drive the whole Infra space forward, and compute management will become a new theme.</p>
<h2 id="side-projects--more-connections">Side Projects ‚Äî More Connections</h2>
<p>In the scattered shapes of GitHub data, the year‚Äôs tinkering is reflected‚Äîthough I‚Äôm sorry I didn‚Äôt contribute more to the open-source community.</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202401/contributions.png" alt="contributions"  />


</p>
<p>My main open-source contribution this year was <a href="https://github.com/alswl/excalidraw-collaboration">alswl/excalidraw-collaboration</a>.
This self-hosted Excalidraw version combines collaboration and Chinese font support. This project and related ones have attracted nearly 300
stars, making it one of my most impactful personal open-source projects, even though it‚Äôs a front-end product.</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202401/excalidraw-collboration.png" alt="excalidraw-collboration"  />


</p>
<p>During the summer, while the little one was away, I built a small app for naming babies. Although the product is a bit unfinished and
losing money, I still hope to spend more time developing and improving it. A good name can bring a family a lot of joy;
I hope this project can at least cover the server costs.</p>
<p>I also became active on Twitter again this year, sharing tips and thoughts. My followers grew from a few hundred to nearly 4,000.
There‚Äôs still a gap to being an influential account, but connecting with many interesting people is rewarding in itself.</p>
<p>My most popular content this year:</p>
<ul>
<li>167k reposts: The war against software complexity <a href="https://twitter.com/alswl/status/1714467723567329309">X</a></li>
<li>160k: English learning experience <a href="https://twitter.com/alswl/status/1742558249260286368">X</a></li>
<li>127k: Introducing Lightboard <a href="https://twitter.com/alswl/status/1726526339568795667">X</a></li>
<li>120k: Web framework discussion ‚Äî Kratos <a href="https://twitter.com/alswl/status/1666118124276699136">X</a></li>
<li>90k: Introducing dumi <a href="https://twitter.com/alswl/status/1684951997752168448">X</a></li>
</ul>
<p>The most valuable post to me was the one about ‚ÄúËÆ∏‰∏ñ‰ºü‚Äôs Architecture Course‚Äù <a href="https://twitter.com/alswl/status/1738411522756665350">X</a>, which earned several months of Twitter subscription fees.</p>
<p>I also started listening to podcasts again and went through most of the ‚ÄúÂÜÖÊ†∏ÊÅêÊÖå‚Äù (Kernel Panic) archive. I missed their active period,
but at the Bund Conference I had a chance to join their meetup and talk with Rio and Âê¥Ê∂õ in person. Ironically, a colleague was there too,
but we didn‚Äôt recognize each other‚Äîa reminder that in a large company, you can work together and still not know each other (we had both been Go language judges).</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202401/panic.png" alt="panic"  />


</p>
<p>Besides ÂÜÖÊ†∏ÊÅêÊÖå, I‚Äôve been listening to ‚ÄúÁ°¨Âú∞È™áÂÆ¢‚Äù without missing an episode, and recently started ‚ÄúÊúâÁü•ÊúâË°å‚Äù as well.</p>
<p>On the blog, I published two posts on engineering practice, hoping they‚Äôd be useful:</p>
<ul>
<li><a href="https://blog.alswl.com/2023/04/web-api-guidelines/">Practical Web API Guidelines</a></li>
<li><a href="https://blog.alswl.com/2023/07/architecture-design-the-easy-way/">Architecture Design the Easy Way</a></li>
</ul>
<p>What I most want to share is the Obsidian Tasks plugin. You can find the details in my post
<a href="https://blog.alswl.com/2023/02/gtd/">From Toodledo to Obsidian Tasks ‚Äî My GTD Best Practice</a>. I‚Äôm also happy to be a sponsor of Obsidian Tasks.</p>
<p>Looking back at the year, I‚Äôve come to realize I only have about 10 hours per week for side projects‚Äîvery precious.
I look forward to financial freedom one day so I can have more time for hobbies and interests.</p>
<h2 id="reading">Reading</h2>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202401/cup.png" alt="cup"  />


</p>
<p>Most of my reading is still non-fiction.</p>
<p><a href="https://book.douban.com/subject/26318286/">Memories of the Cowshed (Ë±ÜÁì£)</a></p>
<p>One can be killed or humiliated; the past brings melancholy, the present confusion, the future hope.</p>
<p><a href="https://book.douban.com/subject/26628557/">Su Shu (Ë±ÜÁì£)</a></p>
<p>On how to conduct oneself and handle affairs‚Äîancient wisdom. Worth rereading; especially helpful to flip through when feeling restless.</p>
<p><a href="https://book.douban.com/subject/26279084/">Translation as the Great Way (Ë±ÜÁì£)</a></p>
<p>Read it to understand the normal and abnormal state of the Chinese language.</p>
<p><a href="https://book.douban.com/subject/26836970/">Dune (Ë±ÜÁì£)</a></p>
<p>The old Baron moves his house to a new planet; the young noble enters the desert world. The Emperor secretly empowers the Harkonnens; House Atreides is judged. Young Paul leads the Fremen; Jessica bears the posthumous child. Muad‚ÄôDib counterattacks on Arrakis, marries Chani and claims the throne.</p>
<p><a href="https://book.douban.com/subject/30147790/">A Hundred Years of Ups and Downs (Ë±ÜÁì£)</a></p>
<p>State, enterprise, people, central, local. Pessimistic.</p>
<p><a href="https://book.douban.com/subject/36150914/">The Courage to Be Disliked (Ë±ÜÁì£)</a></p>
<p>I wish I had read this at 20. (I don‚Äôt need it now.) It teaches how to get along with yourself, others, and the world; how to talk to yourself and change. Same vein as <em>Meeting Your Unknown Self</em>.</p>
<p><a href="https://book.douban.com/subject/24530465/">The Old Regime and the Revolution (Ë±ÜÁì£)</a></p>
<p>Cycles of order and chaos repeat. The unconscious of the crowd; are democracy and elite rule the cure? One measure of stability is the wealth gap. Authoritarian systems also breed the risk of upheaval.</p>
<p><a href="https://book.douban.com/subject/5401859/">Secrets Behind the Door (Ë±ÜÁì£)</a></p>
<p>A quick operations manual for management basics.</p>
<p><a href="https://book.douban.com/subject/33438811/">The Book of Why (Ë±ÜÁì£)</a></p>
<p>I can‚Äôt give this book a star rating‚Äîit‚Äôs beyond my scope. It might be the theory of a new discipline (causal inference), or a spark within statistics. The author, Pearl, is a heavyweight in statistics and AI; in his later years he turned against much of his earlier methodology. Most of the machine learning we know today is based on probabilistic correlation‚Äîfrom beer and diapers to today‚Äôs GPT and AIGC. Pearl argues that what really matters is asking ‚Äúwhy,‚Äù i.e., explaining causation. Causal reasoning requires the ability to imagine what does not exist, which current AI may not grasp (maybe?). The book was published in 2019; the author is now 87. I wonder what he makes of the current AIGC wave.</p>
<p><a href="https://book.douban.com/subject/3248513/">Why Are the Chinese So Hardworking Yet Not Wealthy (Ë±ÜÁì£)</a></p>
<p>The author is right but not comprehensive.</p>
<h2 id="flags">Flags</h2>
<blockquote>
<p>High-quality time with family: put down the phone, get outdoors</p></blockquote>
<p>I did Wednesday and Friday family days with the kids; I take them to school every morning; we always have one weekend day out.</p>
<p>I‚Äôm not as good as my wife at being with the kids‚Äîthanks to her for everything she does for the family.</p>
<blockquote>
<p>Publish at least one post per month, especially on Kubernetes / dev design</p></blockquote>
<p>I published 6 posts this year, 50% of the target. Two of them‚Äî<a href="https://blog.alswl.com/2023/04/web-api-guidelines/">Practical Web API Guidelines</a> and <a href="https://blog.alswl.com/2023/07/architecture-design-the-easy-way/">Architecture Design the Easy Way</a>‚ÄîI‚Äôm quite happy with.</p>
<blockquote>
<p>After COVID, I planned to get a personal trainer for gym workouts</p></blockquote>
<p>Not done.</p>
<blockquote>
<p>Aim for 10% investment return; as a beginner I focused on equity funds. Actual return 3.9%, beating the market and Yu‚Äôe Bao</p></blockquote>
<p>This year‚Äôs return was -1.35%. I got hit right after leaving the beginner village; I still lack understanding of markets and business.</p>
<p>New year‚Äôs flags:</p>
<ul>
<li>High-quality family time, get outdoors, participate together</li>
<li>Keep publishing solid posts, especially on Kubernetes / PaaS</li>
<li>More exercise</li>
<li>Learn the basics of investing and build common sense and logic</li>
</ul>
<h2 id="last">Last</h2>
<p>Every experience, every reunion, every book is a thread of fate. The new year has arrived.
I look forward to continuing to explore the meaning of life with family and friends‚Äîto experience the great and the small.</p>
<p>Past reviews:</p>
<ul>
<li><a href="https://blog.alswl.com/2022/12/2022-review/">2022 Year in Review</a></li>
<li><a href="https://blog.alswl.com/2022/01/20-21/">2021</a></li>
<li><a href="https://blog.alswl.com/2020/03/2019/">Goodbye 2019</a></li>
<li><a href="https://blog.alswl.com/2019/04/2018/">From 2018 to 2019</a></li>
<li><a href="https://blog.alswl.com/2018/01/2017-2018/">From 2017 to 2018</a></li>
<li><a href="https://blog.alswl.com/2015/01/2014/">2014 ÊÉë</a></li>
<li><a href="https://blog.alswl.com/2013/01/my_2012/">My 2012</a></li>
<li><a href="https://blog.alswl.com/2011/12/my-2011/">My 2011</a></li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>How to Build a Blog Comment System with Free Cloud Services</title>
      <link>https://en.blog.alswl.com/2023/11/build-blog-comment-system-based-on-free-cloud-service/</link>
      <pubDate>Sat, 25 Nov 2023 17:23:35 +0800</pubDate>
      <guid>https://en.blog.alswl.com/2023/11/build-blog-comment-system-based-on-free-cloud-service/</guid>
      <description>&lt;h2 id=&#34;the-problem&#34;&gt;The Problem&lt;/h2&gt;
&lt;p&gt;After migrating the blog from WordPress to a static site in 2012, I chose Disqus as the comment system.
Recently, Disqus ads have become too intrusive, so I urgently need to &lt;mark&gt;find a new comment system&lt;/mark&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://help.disqus.com/en/articles/1717119-ads-faq&#34;&gt;Disqus officially&lt;/a&gt; states that removing ads requires a paid subscription.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;What if I want to remove Ads?
If you&amp;rsquo;d like to remove Disqus Ads from your integration, you may purchase and ads-free subscription from your Subscription and Billing page. More information on Disqus ads-free subscriptions may be found here.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<h2 id="the-problem">The Problem</h2>
<p>After migrating the blog from WordPress to a static site in 2012, I chose Disqus as the comment system.
Recently, Disqus ads have become too intrusive, so I urgently need to <mark>find a new comment system</mark>.</p>
<p><a href="https://help.disqus.com/en/articles/1717119-ads-faq">Disqus officially</a> states that removing ads requires a paid subscription.</p>
<blockquote>
<p>What if I want to remove Ads?
If you&rsquo;d like to remove Disqus Ads from your integration, you may purchase and ads-free subscription from your Subscription and Billing page. More information on Disqus ads-free subscriptions may be found here.</p></blockquote>
<p>OK, goodbye Disqus‚ÄîI&rsquo;ll find a reliable, free, and easy-to-use comment system.
Since I&rsquo;m looking for a new comment system anyway, and it&rsquo;s 2023 now,
I want this new system to <mark>fully leverage the convenience of cloud services</mark>, and to be
<mark>free, reliable, and easy to maintain</mark>.</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202311/no-disqus-twitter.png" alt="no-disqus-twitter"  />


</p>
<h2 id="selection-principles">Selection Principles</h2>
<p>Before diving in, I outlined my principles and selection criteria:</p>
<ul>
<li><strong>Data ownership is the core requirement</strong>
<ul>
<li>Ensure comment data fully belongs to the blog owner, with no loss of control due to third-party services.</li>
</ul>
</li>
<li><strong>Deployment and storage are the main challenges</strong>
<ul>
<li>Considering stability and cost, choose a solution that is easy to deploy and has low storage cost.</li>
</ul>
</li>
<li><strong>Access speed is a consideration</strong>
<ul>
<li>Comment system load speed directly affects user experience,
so a system that offers fast access is needed.</li>
</ul>
</li>
</ul>
<p>Functional requirements:</p>
<ul>
<li>Email notifications</li>
<li>Markdown</li>
<li>Content safety: No Injection</li>
<li>Comment moderation and deletion</li>
<li>OAuth login (optional)</li>
</ul>
<p>Non-functional requirements:</p>
<ul>
<li>Low cost: within 12 CNY/year</li>
<li>System stability</li>
</ul>
<p>With these principles and requirements clear, we can choose a suitable comment system in a more targeted way. Next, I&rsquo;ll explore how to select and set up a comment system based on these principles.</p>
<h2 id="initial-exploration">Initial Exploration</h2>
<p>Now let&rsquo;s try out some options and explore, to get familiar with the <mark>features and quality</mark> of common systems today.</p>
<h3 id="utterances"><a href="https://utteranc.es/">utterances</a></h3>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202311/utterances.png" alt="utterances"  />


</p>
<ul>
<li>A comment system often seen in the wild, popular among developers; based on GitHub Issues, so it&rsquo;s free; requires GitHub account to comment.</li>
<li>7.8k stars</li>
<li>Hosted on GitHub Issues</li>
</ul>
<h3 id="twikoo"><a href="https://twikoo.js.org/quick-start.html">Twikoo</a></h3>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202311/twikoo.png" alt="twikoo"  />


</p>
<ul>
<li>A solution from China, built around cloud services; requires a serverless/cloud function environment (most are paid).</li>
<li>880 stars</li>
</ul>
<h3 id="cusdis"><a href="https://cusdis.com/">Cusdis</a></h3>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202311/cusdis.png" alt="cusdis"  />


</p>
<ul>
<li>A solution from China; offers free Cloud service (with limited quota).</li>
<li>2.4k stars</li>
<li>Supports migration</li>
<li>Manual comment approval</li>
<li>Moderate activity</li>
</ul>
<p>I also looked at some external comparison articles:</p>
<ul>
<li><a href="https://gohugo.io/content-management/comments/">Comments | Hugo</a></li>
<li><a href="https://cloud.tencent.com/developer/article/2196035?areaSource=&amp;traceId=">ÈùôÊÄÅÂçöÂÆ¢ËØÑËÆ∫Á≥ªÁªüÁöÑÈÄâÊã© - ËÖæËÆØ‰∫ëÂºÄÂèëËÄÖÁ§æÂå∫-ËÖæËÆØ‰∫ë</a></li>
<li><a href="https://sspai.com/post/73412">ËΩªÈáèÁ∫ßÂºÄÊ∫êÂÖçË¥πÂçöÂÆ¢ËØÑËÆ∫Á≥ªÁªüËß£ÂÜ≥ÊñπÊ°à ÔºàCusdis + RailwayÔºâ - Â∞ëÊï∞Ê¥æ</a></li>
</ul>
<p>From this exploration, the deployment model looks roughly like this:</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202311/comment-system-deploy-diagram.png" alt="comment-system-deploy-diagram"  />


</p>
<h2 id="comparison">Comparison</h2>
<p>Here is a comparison table of features I care about and how each candidate performs. Besides the systems above,
I also looked into <mark>comment SaaS services commonly used overseas</mark>:</p>
<table>
  <thead>
      <tr>
          <th>Name</th>
          <th>self-host</th>
          <th>Official SaaS</th>
          <th>SaaS Free</th>
          <th>Star</th>
          <th>Import Disqus</th>
          <th>export data</th>
          <th>Comments</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Utterances</td>
          <td>x</td>
          <td>v</td>
          <td>v</td>
          <td>7.8k</td>
          <td></td>
          <td>v</td>
          <td>Github account required</td>
      </tr>
      <tr>
          <td>Cusdis</td>
          <td>v</td>
          <td>v</td>
          <td>v?</td>
          <td>2.3k</td>
          <td>v</td>
          <td>v?</td>
          <td>import from Disqus failed</td>
      </tr>
      <tr>
          <td>Cactus Comments</td>
          <td>v</td>
          <td>v</td>
          <td></td>
          <td>100</td>
          <td></td>
          <td></td>
          <td>Matrix Protocol, blocked</td>
      </tr>
      <tr>
          <td>Commento</td>
          <td>x</td>
          <td>v</td>
          <td>$10/month</td>
          <td></td>
          <td>v</td>
          <td>v</td>
          <td></td>
      </tr>
      <tr>
          <td>Graph Comment</td>
          <td></td>
          <td>v</td>
          <td>Free to $7</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
      </tr>
      <tr>
          <td>Hyvor Talk</td>
          <td>x</td>
          <td>v</td>
          <td>$12/month</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
      </tr>
      <tr>
          <td>IntenseDebate</td>
          <td></td>
          <td>v</td>
          <td>?</td>
          <td></td>
          <td>x</td>
          <td></td>
          <td>too old</td>
      </tr>
      <tr>
          <td>Isso</td>
          <td>v</td>
          <td>x</td>
          <td></td>
          <td>4.8k</td>
          <td>v</td>
          <td></td>
          <td>sqlite storage</td>
      </tr>
      <tr>
          <td>Mutt</td>
          <td></td>
          <td>v</td>
          <td>$16/month</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
      </tr>
      <tr>
          <td>Remark42</td>
          <td>v</td>
          <td>x</td>
          <td></td>
          <td>4.3k</td>
          <td>v</td>
          <td>v</td>
          <td>full featured, one file storage</td>
      </tr>
      <tr>
          <td>ReplyBox</td>
          <td></td>
          <td>v</td>
          <td>$5/month</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
      </tr>
      <tr>
          <td>Staticman</td>
          <td>v</td>
          <td></td>
          <td></td>
          <td>2.3k</td>
          <td></td>
          <td>v</td>
          <td>using github as storage</td>
      </tr>
      <tr>
          <td>Talkyard</td>
          <td></td>
          <td>v</td>
          <td>‚Ç¨4.5/ month</td>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
      </tr>
      <tr>
          <td>Waline</td>
          <td>v</td>
          <td></td>
          <td></td>
          <td>1.5k</td>
          <td>v</td>
          <td>v</td>
          <td>Multi Storage / Service Provider supported</td>
      </tr>
      <tr>
          <td>Twikoo</td>
          <td>v</td>
          <td>x</td>
          <td></td>
          <td>1.1k</td>
          <td>v</td>
          <td>v</td>
          <td>FaaS / MongoDB</td>
      </tr>
  </tbody>
</table>
<p>From this comparison we can draw a few conclusions:</p>
<ul>
<li>Traditional overseas comment systems have low data transparency and old-fashioned UIs.</li>
<li>Official SaaS offerings are mostly paid.</li>
<li>Self-hosted options require running your own service, with no one-click free cloud path.</li>
</ul>
<p><strong>Summary</strong></p>
<p>The products that best fit my needs are: Utterances, Cusdis, and Waline.</p>
<h2 id="poc-and-implementation">PoC and Implementation</h2>
<p>I eventually chose Utterances and Waline for a PoC.
My <a href="https://en.blog.alswl.com/">English blog</a> uses Utterances,
and my <a href="https://blog.alswl.com/">Chinese blog</a> uses Waline.</p>
<p>Why not Cusdis or Twikoo? Cusdis uses PostgreSQL,
while Twikoo relies on Tencent Cloud Functions (limited free tier) or MongoDB.
Waline offers more storage options.
Among similar solutions, Waline has the most contributors and commits,
so the community is more reliable.</p>
<h3 id="waline-implementation">Waline Implementation</h3>
<blockquote>
<p>One funny detail: if the h3 heading here were &ldquo;Waline&rdquo;, it would inject the comment widget for this blog right there.</p></blockquote>
<ul>
<li>Pros
<ul>
<li>Multi-platform deployment</li>
<li>Multiple database backends (MongoDB, sqlite, PostgreSQL, MySQL)</li>
<li>Rich comment features</li>
<li>Import tools</li>
<li>Active enough</li>
</ul>
</li>
<li>Cons
<ul>
<li>Feature-heavy, not very minimal (but configurable)</li>
<li>Product from China</li>
</ul>
</li>
<li>Integration steps:
<ul>
<li>Choose a storage provider (I chose <mark>LeanCloud</mark>)</li>
<li>Choose a server provider for deployment (I chose <mark>Vercel</mark>)</li>
<li>Choose an email provider (I chose <mark>Brevo</mark> (formerly SendinBlue))</li>
<li>Frontend integration (embed in Hugo)</li>
</ul>
</li>
</ul>
<p>Deployment diagram:</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202311/waline.png" alt="waline"  />


</p>
<p>For the actual steps, follow the official docs:</p>
<ul>
<li><a href="https://waline.js.org/guide/get-started/">Quick Start | Waline</a></li>
<li><a href="https://waline.js.org/guide/deploy/vercel.html#%E5%A6%82%0E4%BD%95%E9%83%A8%E7%BD%B2">Deploy on Vercel | Waline</a></li>
<li>Bind CNAME</li>
<li>Import data
<ul>
<li>Convert with <a href="https://waline.js.org/migration/tool.html">Migration Tool | Waline</a></li>
<li>Import at <a href="https://console.leancloud.app/apps/yours/storage/import-export">https://console.leancloud.app/apps/yours/storage/import-export</a></li>
</ul>
</li>
<li>Page configuration
<ul>
<li>Disable some features via <a href="https://waline.js.org/reference/client/props.html">client props</a></li>
<li>Enable SMTP
<ul>
<li>Set <code>AUTHOR_EMAIL</code></li>
<li>Set <code>SENDER_NAME</code></li>
<li>Set <code>SENDER_EMAIL</code></li>
</ul>
</li>
<li>Server config: <a href="https://waline.js.org/reference/server/config.html#tgtemplate">https://waline.js.org/reference/server/config.html#tgtemplate</a></li>
</ul>
</li>
<li>Issues I ran into
<ul>
<li>Disqus export does not include user emails, so Gravatar avatars don&rsquo;t show; no workaround</li>
<li>Email config needs extra env vars, otherwise your personal email can be exposed</li>
</ul>
</li>
</ul>
<p>Implementation PR (frontend only; backend contains secrets and isn‚Äôt shared):
<a href="https://github.com/alswl/blog.alswl.com/commit/e34e34810298fd0d716d4c4a467fada25b3a6622">feat: comments on waline ¬∑ alswl/blog.alswl.com@e34e348</a></p>
<h3 id="utterances-implementation">Utterances Implementation</h3>
<p>Utterances is even simpler to set up‚Äîa single PR enables it.
<a href="https://github.com/alswl/en.blog.alswl.com/commit/29028f677e362570a8bcaf5316847ddfa3e9d685">feat: comment using utteranc ¬∑ alswl/en.blog.alswl.com@29028f6 (github.com)</a></p>
<p>Nothing fancy, just simplicity. Given the low traffic on my English blog, the minimal approach works.</p>
<h2 id="summary">Summary</h2>
<p>I ended up with Waline and Utterances as my comment systems; both have zero deployment cost.</p>
<p>I traded some access speed and security for better data control and a self-hosted setup.
In terms of stability, although the chain is more complex and a single node can fail,
relying on Vercel, LeanCloud, and Brevo keeps overall risk manageable.</p>
<p>After all, it‚Äôs just a small comment system‚Äîzero cost and ‚Äúit works‚Äù is enough.</p>
<p>Feel free to try leaving a comment below.</p>
]]></content:encoded>
    </item>
    <item>
      <title>GitOps and Version Management</title>
      <link>https://en.blog.alswl.com/2023/09/gitops-and-version-management/</link>
      <pubDate>Sat, 23 Sep 2023 18:22:27 +0800</pubDate>
      <guid>https://en.blog.alswl.com/2023/09/gitops-and-version-management/</guid>
      <description>&lt;p&gt;




&lt;img loading=&#34;lazy&#34; src=&#34;https://en.blog.alswl.com/images/202309/car.png&#34; alt=&#34;car&#34;  /&gt;


&lt;/p&gt;
&lt;p&gt;&lt;small&gt;image via &lt;a href=&#34;https://www.shipvehicles.com/step-by-step-guide-for-state-to-state-transport/&#34;&gt;shipvehicles&lt;/a&gt;&lt;/small&gt;&lt;/p&gt;
&lt;p&gt;Using GitOps to manage delivery content is a common DevOps practice. We use Git for version control and Git tags to track the versions of deployed software. While this may seem to work, the concept of versioning is far from that simple in the age of cloud-native technology.&lt;/p&gt;
&lt;h2 id=&#34;the-version-problem&#34;&gt;The Version Problem&lt;/h2&gt;
&lt;p&gt;After introducing GitOps into the DevOps workflow, we can leverage GitOps for continuous integration and continuous delivery. GitOps addresses three core concerns: &lt;strong&gt;content&lt;/strong&gt;, &lt;strong&gt;version&lt;/strong&gt;, and &lt;strong&gt;collaboration&lt;/strong&gt;. Yet we often focus on content and overlook version management.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202309/car.png" alt="car"  />


</p>
<p><small>image via <a href="https://www.shipvehicles.com/step-by-step-guide-for-state-to-state-transport/">shipvehicles</a></small></p>
<p>Using GitOps to manage delivery content is a common DevOps practice. We use Git for version control and Git tags to track the versions of deployed software. While this may seem to work, the concept of versioning is far from that simple in the age of cloud-native technology.</p>
<h2 id="the-version-problem">The Version Problem</h2>
<p>After introducing GitOps into the DevOps workflow, we can leverage GitOps for continuous integration and continuous delivery. GitOps addresses three core concerns: <strong>content</strong>, <strong>version</strong>, and <strong>collaboration</strong>. Yet we often focus on content and overlook version management.</p>
<p>What version-management issues need to be solved in a GitOps process?</p>
<p>A complete GitOps solution includes content description (Manifest), build strategy (Builder), and application strategy (Applier). Content description has given rise to many description languages, from traditional <a href="https://www.ansible.com/">Ansible</a> / <a href="https://www.chef.io/products/chef-infra">Chef</a> to cloud and cloud-native favourites like <a href="https://www.terraform.io/">Terraform</a>, <a href="https://helm.sh/">Helm</a>, and <a href="https://kustomize.io/">Kustomize</a>. With so many ways to describe content, pinning down an application‚Äôs version becomes very complex.</p>
<p>When we talk about version, do we <mark>mean the version of the application source code, the version of an image, or the version of an infrastructure-as-code (IaC) repository</mark>? Furthermore, when releasing a set of related applications‚Äîe.g. frontend and backend, or a system made of multiple backend apps‚Äîhow do we clearly describe the <mark>version dependencies</mark> between them?</p>
<p>Inaccurate versioning leads to problems such as wrong release versions, tangled application dependencies, and inability to roll back.</p>
<p>Many teams handle this vaguely: ship the latest version, deploy backend before frontend. In a complex product team or one that must maintain multiple stable versions, this rough approach is not acceptable.</p>
<p>Version management addresses not only <mark>version identification</mark> but also <mark>dependencies</mark> between applications. GitOps version management therefore needs to answer:</p>
<ul>
<li>How to build artifacts delivered to customers, how to define their versions, and how to present all versions.</li>
<li>How to resolve version dependencies when a set of software has them.</li>
<li>How to describe a system when a set of software forms one.</li>
</ul>
<p>Version management is important for any delivered product. We will break down this topic step by step and move from the original questions to GitOps version-management best practices.</p>
<h2 id="a-brief-introduction-to-gitops">A Brief Introduction to GitOps</h2>
<p>Before going further, here is a short overview of GitOps so we share the same understanding of key concepts.</p>
<p>The core idea of GitOps is <mark>infrastructure as code (IaC)</mark>: using declarative descriptions instead of imperative ones. IaC content is usually based on some paradigm that describes the desired state of a target. That paradigm can be Terraform, Kubernetes YAML, <a href="https://www.pulumi.com/">Pulumi</a>, or even Ansible. The target can be cloud services, Kubernetes, or physical machines. In short, by using YAML instead of Bash scripts, we can greatly improve the accuracy and controllability of changes.</p>
<p>For GitOps, whether you use Git is not the main point; you could use SVN. Git is simply more widely used and fits well with team collaboration and CI/CD. With a Git repository, you also get versioning based on Git revision / tag / branch, which in practice means version history and managing multiple versions in parallel.</p>
<p>Describing things only by Git revision is still not enough for real-world needs.</p>
<h2 id="the-root-of-the-problem--versions-of-binaries-and-startup-config">The Root of the Problem ‚Äî Versions of Binaries and Startup Config</h2>
<p>When we trace versions to their source, the most primitive version is the version of the code.</p>
<p>What is the version of the code? Is it the version in the code repository or the version of the application built from that code? This version is not the version in the version-control system (e.g. Git / Mercurial / SVN). Although the two are often related, the code itself is just a set of files; once a build succeeds, there is a version. If it is not defined, the version is unknown and not tied to the repository.</p>
<blockquote>
<p>Note: From here on we do not distinguish between Git / Mercurial / SVN; we use Git as the stand-in for all of them.</p></blockquote>
<p>Also note that in Chinese there are two concepts (Â∫ì Library and ‰ªìÂ∫ì Repository). In neither case does it imply that a ‚Äúlibrary‚Äù must be a versioned (Git/SVN) repository‚Äîwe are not assuming code is always under version control. When we pack source files into a zip (e.g. GitHub‚Äôs zip download), that zip is still a codebase even if it has lost all Git history.</p>
<p>The version of the code is effectively the <mark>version of the application</mark>, as intended by the author. It is usually in the form <code>vx.y.z</code> rather than a Git commit hash, and the most common approach is <a href="https://semver.org/">semantic versioning</a>.</p>
<p>I recommend storing the version in a <code>VERSION</code> file in the code tree. For example, Git‚Äôs <a href="https://github.com/git/git/blob/master/GIT-VERSION-GEN">Version</a> file clearly shows the current version:</p>
<pre tabindex="0"><code>GVF=GIT-VERSION-FILE
DEF_VER=v2.42.GIT
</code></pre><p>The <code>.GIT</code> suffix indicates the code is in development mode. If we switch to a release, e.g. <a href="https://github.com/git/git/blob/v2.39.3/GIT-VERSION-GEN">v2.39.3</a>, we see <code>DEF_VER=v2.39.3</code>, a standard artifact version. Two best practices here:</p>
<ul>
<li>Use a file to store the source version.</li>
<li>The version file in source is always in <code>dev</code> mode; it becomes an official version only after a release tag.</li>
</ul>
<p>The output of the source is not only binaries, executables, and dynamic libraries (<code>.dll</code> / <code>.so</code> / <code>.dylib</code>) but also the corresponding startup configuration files. These configs are usually managed together with the version‚Äîe.g. Nginx‚Äôs <code>nginx.conf</code> and Redis‚Äôs <code>redis.conf</code> should be under version control.</p>
<p>What is built from the source repository is the <strong>artifact</strong>. Artifacts already have two versions:</p>
<ul>
<li>Source version, i.e. the version defined in the <code>VERSION</code> file.</li>
<li>Source repository version, i.e. Git revision.</li>
</ul>
<h2 id="artifact-version-management">Artifact Version Management</h2>
<p>With artifact version management, things get more complex because artifacts introduce more questions:</p>
<ul>
<li>What is an artifact and what does it consist of? (Answered above.)</li>
<li>How is an artifact installed? What is the installer and what is the runtime?</li>
<li>How is artifact information managed centrally? How is data managed?</li>
<li>Do artifacts depend on each other? How are dependencies and version constraints handled?</li>
</ul>
<p>The concept of artifact is central. One key idea: <mark>artifacts can be turned into new artifacts by packers</mark>.</p>
<p>Because artifacts have versions and new artifacts get new versions, we end up with multiple layers. To avoid losing the original version, we extend the notion of version to <mark>Upstream Version</mark>‚Äîthe version assigned by the software author, the source of all versions.</p>
<p>Why can one artifact become another? Consider containers in Kubernetes. A container is a delivery format: it puts the executable and startup config into an image that can run in a container environment. The image in a registry is itself an artifact.</p>
<p>Helm / Kustomize are also delivery formats (packaging toolchains). Each layer solves a specific problem and can run in a given environment (e.g. container, Kubernetes, cloud infrastructure).</p>
<p>Every artifact is built and has its own <mark>packaging info</mark>, which can change and thus add another version. In practice we want the artifact‚Äôs version tied to its upstream version. Each packaging mechanism may have its own config but should still follow the upstream version. For example, a Kubernetes Workload references an image; the Workload description is extra info, while the image remains under upstream control.</p>
<p><mark>Artifact + Packaging Info = New Artifact</mark>. Artifacts are packed into new artifacts until the final installer deploys them into the target environment.</p>
<p>When these artifacts can be described in files (IaC), we get various IaC repositories, which are the core objects of GitOps.</p>
<h2 id="concepts-at-a-glance">Concepts at a Glance</h2>
<p>Here is a concise map of these concepts:</p>
<table>
  <thead>
      <tr>
          <th>Chinese</th>
          <th>English</th>
          <th>Explanation</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Ê∫ê‰ª£Á†Å</td>
          <td>Source Code</td>
          <td>The set of source files for a program or application</td>
      </tr>
      <tr>
          <td>‰ª£Á†Å‰ªìÂ∫ì</td>
          <td>Source Code Repo</td>
          <td>The unit of version control that holds the source code</td>
      </tr>
      <tr>
          <td>ÁâàÊú¨</td>
          <td>Version</td>
          <td>Application version corresponding to the source; human-defined, semantic; sometimes called Upstream Version</td>
      </tr>
      <tr>
          <td>ÂèØÊâßË°åÊñá‰ª∂</td>
          <td>Executable File</td>
          <td>Build output, usually an ELF executable or a library</td>
      </tr>
      <tr>
          <td>ÂêØÂä®ÈÖçÁΩÆÊñá‰ª∂</td>
          <td>Configuration File</td>
          <td>Startup config for the ELF/Lib, distinct from general config (e.g. Kubernetes YAML)</td>
      </tr>
      <tr>
          <td>Âà∂ÂìÅ</td>
          <td>Artifact</td>
          <td>A set of executable + startup config that can run in a runtime; usually file-based; artifacts can nest other artifacts</td>
      </tr>
      <tr>
          <td>ÂÆâË£ÖÂô®</td>
          <td>Installer</td>
          <td>Tool that installs the artifact into the runtime</td>
      </tr>
      <tr>
          <td>ËøêË°åÊó∂</td>
          <td>Runtime</td>
          <td>Environment where the artifact runs, e.g. an OS, Kubernetes, Docker Engine</td>
      </tr>
      <tr>
          <td>ÊâìÂåÖÂô®</td>
          <td>Packer</td>
          <td>Tool that packs artifacts into a given format (new artifact)</td>
      </tr>
      <tr>
          <td>ÊâìÂåÖÈôÑÂ±û‰ø°ÊÅØ</td>
          <td>Packaging Info</td>
          <td>Extra info needed when packing, e.g. container OS, process resources, default env vars</td>
      </tr>
  </tbody>
</table>
<p>Together these concepts form the core of artifact version management and help us manage and trace versions and their relationships.</p>
<h3 id="packer">Packer</h3>
<p>A packer is a tool that turns artifacts into a specific format via packaging (compile, link, merge, archive, etc.), producing a new artifact. Its input is usually upstream‚Äîeither source code or artifacts produced by another system.</p>
<p>For example, when packaging Docker Compose, the input is images; for Helm, the input includes images, startup config, and Helm templates, and the output is YAML.</p>
<h3 id="artifacts">Artifacts</h3>
<p>An artifact is a collection of data that can run in a given environment. It is made of executables and startup config, usually as files, and runs in a runtime. Artifacts can nest other artifacts.</p>
<p>The most common form is a binary (ELF); it can also be something that runs in a specific environment, such as a container image. Artifacts are typically transferred as files.</p>
<h3 id="installer">Installer</h3>
<p>An installer is a tool that puts an artifact into a runtime. It deploys the artifact and ensures it runs. Examples: dpkg, Pacman, or self-extracting installers on Windows. For Kubernetes, we use <code>kubectl</code>; Helm uses the <code>helm</code> command.</p>
<h2 id="linux-community-practice">Linux Community Practice</h2>
<p>Once we understand these concepts, we may notice how close they are to what the Linux community has been doing for years. Setting aside cloud-native buzzwords, the Linux world already had a full solution.</p>
<p>Each layer of artifacts introduces new config / extension / values / env vars‚Äîwe call all of this <strong>configuration</strong>. This packaging info brings its own challenges at scale.</p>
<blockquote>
<p>Proudly using Arch Linux.</p></blockquote>
<h3 id="arch-linux-practice">Arch Linux Practice</h3>
<p>Arch Linux uses <a href="https://wiki.archlinux.org/title/Pacman">Pacman</a> as the package installer and has a full <a href="https://wiki.archlinux.org/title/Arch_build_system">build system</a>. The <a href="https://wiki.archlinux.org/title/PKGBUILD">PKGBUILD</a> describes how a package is built; it is a Bash subset and the core file for the package.</p>
<p>For versioning, Arch has a clear scheme and a full <mark>artifact nesting</mark> story. In <code>PKGBUILD</code>, <code>pkgver</code> is the upstream version (with normalisation such as <code>_</code> for <code>-</code> and timestamp format). <code>pkgrel</code> is the release number (not build number); it is incremented on each release to track Arch releases. When most of the <code>PKGBUILD</code> changes, the release number changes. <code>epoch</code> is a last-resort mechanism to force a newer version by breaking version comparison; it defaults to 0 and is hidden.</p>
<p><code>PKGBUILD</code> also uses versioned dependencies to handle modules. For example, the <code>base-devel</code> package depends on 26 base packages, and <a href="https://gitlab.archlinux.org/archlinux/packaging/packages/base-devel/-/blob/main/PKGBUILD">that package itself</a> has <mark>no content</mark>. This avoids introducing a separate model (e.g. Group / Product).</p>
<h2 id="gitops-based-version-management">GitOps-Based Version Management</h2>
<p>Back to GitOps version management: with the analysis above, can we answer the original questions?</p>
<ul>
<li>How are customer-facing artifacts composed, how do we define their version, and how do we present all versions?
<ul>
<li>Use a <code>VERSION</code> file for the software (upstream) version.</li>
<li>Each artifact form has its own version, tied to upstream‚Äîe.g. <code>v1.2.3-afe12c</code> for the Git repo, <code>v1.2.3-afe12c-b1</code> for the image build.</li>
</ul>
</li>
<li>How do we resolve version dependencies within a set of software?
<ul>
<li>Leave this to the installer; the metadata is usually in the packaging info and consumed by the installer.</li>
</ul>
</li>
<li>How do we represent a system formed by a set of software?
<ul>
<li>Create a new artifact with no upstream version; its content may be empty but it carries packaging and dependency info.</li>
<li>Alternatively, introduce a dedicated concept; that depends on how the packer and installer work together.</li>
</ul>
</li>
</ul>
<h2 id="summary">Summary</h2>
<p>The wisdom of version management is already present in RPM / DEB / PKGBUILD. We give the application author the right to define version, we allow artifact nesting, and we let versioning span multiple layers.</p>
<p>We want the version of the running artifact to still be derived from the original application (Upstream) version. In large-scale cluster management, it matters that every running program knows where it came from and what it is.</p>
]]></content:encoded>
    </item>
    <item>
      <title>Architecture Design the Easy Way</title>
      <link>https://en.blog.alswl.com/2023/07/architecture-design-the-easy-way/</link>
      <pubDate>Sat, 29 Jul 2023 14:54:27 +0800</pubDate>
      <guid>https://en.blog.alswl.com/2023/07/architecture-design-the-easy-way/</guid>
      <description>&lt;p&gt;




&lt;img loading=&#34;lazy&#34; src=&#34;https://en.blog.alswl.com/images/202307/arch-easy.png&#34; alt=&#34;arch-easy&#34;  /&gt;


&lt;/p&gt;
&lt;p&gt;&lt;small&gt;image via &lt;a href=&#34;https://pixabay.com/photos/child-tower-building-blocks-blocks-1864718/&#34;&gt;Pixabay&lt;/a&gt;&lt;/small&gt;&lt;/p&gt;
&lt;h2 id=&#34;overview&#34;&gt;Overview&lt;/h2&gt;
&lt;p&gt;A few days ago, I gave an internal tech talk to my team on best practices for architecture design. I condensed these practices into a &lt;mark&gt;20-character mantra&lt;/mark&gt;:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Architecture looks at the problem&lt;/li&gt;
&lt;li&gt;Requirements look at use cases&lt;/li&gt;
&lt;li&gt;Design looks at the model&lt;/li&gt;
&lt;li&gt;Details look at the sequence&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;I shared this mantra on &lt;a href=&#34;https://twitter.com/alswl/status/1683778487726006272&#34;&gt;Twitter&lt;/a&gt;, and many friends showed strong interest and wanted to go deeper. So I expanded the ideas from that talk into this article.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202307/arch-easy.png" alt="arch-easy"  />


</p>
<p><small>image via <a href="https://pixabay.com/photos/child-tower-building-blocks-blocks-1864718/">Pixabay</a></small></p>
<h2 id="overview">Overview</h2>
<p>A few days ago, I gave an internal tech talk to my team on best practices for architecture design. I condensed these practices into a <mark>20-character mantra</mark>:</p>
<ol>
<li>Architecture looks at the problem</li>
<li>Requirements look at use cases</li>
<li>Design looks at the model</li>
<li>Details look at the sequence</li>
</ol>
<p>I shared this mantra on <a href="https://twitter.com/alswl/status/1683778487726006272">Twitter</a>, and many friends showed strong interest and wanted to go deeper. So I expanded the ideas from that talk into this article.</p>
<h2 id="architecture-design-and-system-analysis">Architecture Design and System Analysis</h2>
<p>Let‚Äôs first clarify <mark>what architecture design and system analysis are</mark> (the latter often shortened to ‚Äúsystem analysis‚Äù). Some of you are familiar with the first but not the second. No worries‚Äîhere‚Äôs how Wikipedia introduces them:</p>
<blockquote>
<p><strong>Architecture</strong>: <strong>Software architecture</strong> is an abstract description of the overall structure and components of software, used to guide the design of various aspects of large software systems.</p>
<p><strong>System analysis</strong> aims to study the interactions between parts (subsystems) in a given system structure, the system‚Äôs external interfaces and boundaries, and the behavior, functions, and limitations of the system as a whole, so as to provide reference and basis for future changes and related decisions.</p></blockquote>
<p>The English definitions may make it clearer:</p>
<ul>
<li>Architecture = Software Architecture (design) = <a href="https://en.wikipedia.org/wiki/Software_architecture">Software architecture - Wikipedia</a></li>
<li>System analysis = <a href="https://en.wikipedia.org/wiki/Systems_analysis">Systems analysis - Wikipedia</a> + <a href="https://en.wikipedia.org/wiki/Systems_design">Systems design - Wikipedia</a></li>
</ul>
<p>What we sometimes call ‚Äúdesign docs‚Äù may cover the whole design process: architecture design, system analysis, and other design activities (communication, PoC, etc.).</p>
<p>Software Architecture (design) = Software Architecture</p>
<ul>
<li>Define and implement the basic structure and organization of software systems</li>
<li>At the business level: clarify the problem, define concepts, present value</li>
<li>At the technical level: choose foundational frameworks, turn uncertainty into certainty</li>
<li>At the engineering level: identify boundaries, split modules, improve development efficiency</li>
</ul>
<p>System Analysis = System Analysis</p>
<ul>
<li>The process of analyzing and studying business needs and problems</li>
<li>At the business level: requirement gathering, requirement analysis</li>
<li>At the technical level: modeling, flowcharts, data flow diagrams, interface design</li>
<li>At the engineering level: implementing requirements within applications and system frameworks</li>
</ul>
<p>Finally, how I see the boundary between the two: I believe <mark>there is no sharp line between architecture design and system analysis</mark>. Any system or module will go through system analysis. You start thinking in terms of architecture when:</p>
<ul>
<li>More than three teams are collaborating, because that involves interests and boundaries.</li>
<li>You begin to introduce uncertainty, whether actively or passively.</li>
<li>You are making trade-offs: what to do first, what to do next.</li>
<li>The system is so complex that it‚Äôs hard to reach consensus and explanation cost rises.</li>
<li>You can provide information others don‚Äôt have.</li>
</ul>
<h2 id="what-is-architecture">What Is Architecture</h2>
<p>Here we focus on <strong>technical</strong> architecture, not business or product architecture. The emphasis is <mark>how to use technical capabilities and methods more efficiently to solve a certain type of problem</mark>.</p>
<p>Technical architecture can be split in two: one is <mark>top-down</mark>‚Äîbusiness, strategy, and framework division; the other is <mark>focused on engineering and implementation (coding)</mark>.</p>
<p>Experienced people often have a more macro view. Common terms include: global, macro, domain, strategy, balance, planning. I turned these into a word cloud:</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202307/word-cloud-arch-biz.png" alt="word-cloud-arch-biz"  />


</p>
<p><small>generated by <a href="https://tendcode.com/tool/word-cloud/">https://tendcode.com/tool/word-cloud/</a></small></p>
<p>These concepts matter a lot in architecture design and system analysis, because they help us think about the whole picture and even beyond technology‚Äîfrom business value, commercial strategy, and business strategy.</p>
<p>The other kind of architecture is more about engineering design and implementation. Typical keywords: domain modeling, UML, GoF 23, SOLID, high cohesion and low coupling, etc. Word cloud:</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202307/word-cloud-arch-impl.png" alt="word-cloud-arch-impl"  />


</p>
<p><small>generated by <a href="https://tendcode.com/tool/word-cloud/">https://tendcode.com/tool/word-cloud/</a></small></p>
<p>Architecture is a broad topic. This article picks one angle: <mark>making architectural thinking useful in day-to-day work through practice and methodology, to cover about 80% of engineering design and development scenarios</mark>. I call this ‚Äúarchitecture design the easy way.‚Äù</p>
<h2 id="minimalist-architecture-design--architecture-looks-at-the-problem">Minimalist Architecture Design ‚Äî Architecture Looks at the Problem</h2>
<p>The first and most important step in understanding architecture is to focus on the <strong>problem</strong>: <mark>what problem are you facing, and how will you solve it?</mark></p>
<p>Usually, if our business and systems run stably and we don‚Äôt run into problems, we don‚Äôt need much architecture design. But whenever we do architecture design, it‚Äôs because we have a problem. The problem may come from new requirements, changes in the environment, or the system‚Äôs own evolution. Whatever the source, we have a problem.</p>
<p>After we have a problem, how do we solve it? Like ‚Äúputting the elephant in the fridge,‚Äù we break it into steps.</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202307/elephant.png" alt="Putting the elephant in the fridge"  />


</p>
<p><small>image via unknown</small></p>
<p>So solving a problem has three steps: first describe the problem clearly, second negotiate and decide until there is agreement, third take action to solve it.</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202307/q-n-a.png" alt="Problem ‚Äî Agreement ‚Äî Action"  />


</p>
<p>One more question that might sound silly: why can‚Äôt we just solve the problem directly?</p>
<p>Because problems are complex; there are many solution paths, and different options have different pros, cons, and costs. In architecture design we need to make these decisions.</p>
<p>Then why not just make the decision, or even start coding right away?</p>
<p>First, there may be authority issues‚Äîthe architect may not have final say; someone with decision rights may need to sign off. Second, the architect may not be an expert in every area; designing a complex system often requires coordinating multiple parts and domain experts to evaluate and decide together.</p>
<h3 id="example">Example</h3>
<p>Take Prometheus‚Äôs architecture as an example.</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202307/prometheus-architecture.png" alt="Prometheus architecture"  />


</p>
<p><small>image via <a href="https://prometheus.io/docs/introduction/overview/">Prometheus</a></small></p>
<p>This diagram answers many questions. A few examples:</p>
<ul>
<li>Problem: Push or pull for data collection? What storage? How to design the alerting pipeline?</li>
<li>Decisions: Pull (Pushgateway in a few cases); custom TSDB; Alertmanager to integrate with external systems</li>
<li>ROI: Pull reduces observability cost on targets, no need for a push-based registry; no suitable external implementation at the time; Router/Sub alert mechanism for flexible integration</li>
</ul>
<h3 id="summary">Summary</h3>
<p>Problems drive architecture change; the architecture addresses the problem; architecture review aligns on the solution.</p>
<p>On who gets to decide: I strongly believe architects should form their own view based on domain knowledge, industry judgment, and understanding of the current situation. That thinking should be supported by cause and effect. <mark>A good architect must have a point of view.</mark></p>
<p>One small add: why didn‚Äôt I mention architecture layers or module layers?</p>
<p>Not because layering and frameworks don‚Äôt matter‚Äîeveryone is already professional there. Layering and modularity are basic common sense and skills, so they usually aren‚Äôt the focus of debate and decisions. If you can‚Äôt quickly agree on layers and frameworks, either the team composition is off or the problem is so complex it‚Äôs no longer in the 80% case.</p>
<p>Deliverables at this stage: architecture diagram and shared understanding of problem, value, cost, risk, and responsibilities.</p>
<h2 id="minimalist-architecture-design--requirements-look-at-use-cases">Minimalist Architecture Design ‚Äî Requirements Look at Use Cases</h2>
<p>Requirements are the answer to the problem. I like to <mark>use mind maps or a blank sheet to draw</mark> and make requirements clear. What to draw? Clarify roles and list actions and behaviors.</p>
<p>What‚Äôs a good way to organize everything? I often use a <mark>subject‚Äìverb‚Äìobject (and adjuncts)</mark> approach: who does what, in what scenario (optional), in what state (optional).</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202307/gramma.jpg" alt="Subject-verb-object"  />


</p>
<p><small>image via unknown</small></p>
<p>Use cases break requirements down clearly, and you keep communicating with the stakeholders in the process.</p>
<p><mark>Demo scripts are the product manager‚Äôs weapon; requirement use cases are the engineer‚Äôs weapon.</mark></p>
<p>Some junior engineers unconsciously become mere executors of requirements. I‚Äôd say engineers who don‚Äôt understand the business aren‚Äôt much different from outsourced labor. The requirement analysis phase is crucial‚Äîit‚Äôs the chance to understand, structure, and redesign the business input. By organizing use cases, we can push back on unrealistic or unreliable requirements.</p>
<p>This is one of the few phases where we can influence (and give feedback to) the requirement side; make the most of it.</p>
<h3 id="example-1">Example</h3>
<p>Here‚Äôs an example of a product use case:</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202307/netease-music.png" alt="Netease Cloud Music"  />


</p>
<p><small>image via <a href="https://www.woshipm.com/evaluating/3493594.html">Netease Cloud Music product analysis</a></small></p>
<p>This use case was actually summarized by ‚Äúthe other side‚Äù üòÑ, but it still shows how important use cases are.</p>
<h3 id="summary-1">Summary</h3>
<p>Besides subject‚Äìverb‚Äìobject, other useful techniques:</p>
<ul>
<li>User journey (action path): imagine the path the user (or actor) takes to reach their goal</li>
<li>Prioritize solving the 20% of issues on the core path</li>
<li>Organize use cases by role, orthogonal split, etc.; assign use cases to modules</li>
</ul>
<p>Deliverables: demo script, use case diagram.</p>
<h2 id="minimalist-architecture-design--design-looks-at-the-model">Minimalist Architecture Design ‚Äî Design Looks at the Model</h2>
<p>To me, the core of design is the <strong>model</strong>: <mark>the model defines the carrier and boundaries of data</mark>. <mark>Data defines the components; boundaries define ownership and responsibility.</mark> In UML, many entities and objects are used to define model boundaries. As the business system grows in complexity, modeling faces greater challenges.</p>
<p>A few modeling principles I use:</p>
<ul>
<li>Define terms (in both languages if needed), meaning, and notes.</li>
<li>Identify core models (focus on the critical 20%).</li>
<li>Refine and abstract models.</li>
<li>Make relationships between models explicit.</li>
<li>Combine static and dynamic: a few models have behavior; focus on the functions they provide.</li>
<li>Map business model ‚Üî data model.</li>
</ul>
<p>Many people don‚Äôt care about a glossary, but I do. There‚Äôs an effect called ‚Äúforeign language effect‚Äù‚Äîlike using Latin/Greek in natural history to describe species. For non-native English engineers, using English for terms can help focus the discussion.</p>
<p>Always keep the 80/20 rule in mind, especially in design: focus on core objects and zoom in on them rather than getting lost in details. Usually, focusing on the core 20% of models is enough for most scenarios.</p>
<p>When refining and abstracting models, iterate carefully. You can connect this to earlier use case definition and later sequence design; it takes solid domain knowledge. I like to refer to external code and designs at this stage.</p>
<p>Relationships between models are mainly 1:1, 1:N, M:N. Use arrows to show primary vs. secondary clearly. Primary/secondary implies ownership and affects many downstream details (URLs, database, lifecycle, etc.). I recommend avoiding M:N when possible; it often indicates an intermediate credential or relationship/binding.</p>
<p>Besides static data, consider model behavior (only a few models have it). This stage can feed into the next step‚Äîdetailed design.</p>
<p>After the business model, think about the data model. For typical business systems, this mapping is straightforward. Business systems are often stateless and rely on the database for storage. For data-intensive applications (DIA), you need to think about runtime data, lifecycle, and availability (if you have that need, you probably aren‚Äôt reading this far üòÑ).</p>
<h3 id="example-2">Example</h3>
<p>Kubernetes RBAC (Role-Based Access Control) is a common AuthZ (authorization) system (not AuthN‚Äîauthentication).</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202307/rbac.png" alt="Kubernetes RBAC"  />


</p>
<p><small>image via <a href="https://dev.to/alcide/kubernetes-rbac-moving-from-it-s-complicated-to-in-a-relationship-1bbm">Kubernetes RBAC - DEV Community</a></small></p>
<p>A few questions to consider:</p>
<ul>
<li>Why both Role and ClusterRole? What‚Äôs their structure?</li>
<li>Why not ACL? What‚Äôs the difference between ACL and RBAC?</li>
<li>Why not Policy?</li>
</ul>
<p>Modeling is what gives you these answers.</p>
<h3 id="models-in-non-business-systems">Models in Non-Business Systems</h3>
<p>We‚Äôve been focusing on business models‚Äîwhat users perceive and the product understands, usually stored in the DB.</p>
<p>In infrastructure, there are models too, sometimes called ‚Äúconcepts.‚Äù Infrastructure models are often simpler; business models can be very complex because the world is complex, while infrastructure focuses on narrow, vertical problems.</p>
<p>Infrastructure also leads to more abstract modeling‚Äîe.g. the often-overlooked Manager/Service pattern. Models with data and state, like Executor, are common; Registry and Queue are common too.</p>
<p>Kubernetes <a href="https://kubernetes.io/docs/concepts/">Concepts</a>‚Äîdozens of subcategories and hundreds of concepts‚Äîshow how complex such a system can be.</p>
<h3 id="summary-2">Summary</h3>
<p>Models are not just data; they define boundaries, and boundaries determine ownership and responsibility.</p>
<p>Design models in both static and dynamic terms: statically what they hold, dynamically what they do.</p>
<p>In infrastructure, deliverables may include UML model diagram, ER diagram, DB DML, class files, OpenAPI/Swagger (partially), etc.</p>
<h2 id="minimalist-architecture-design--details-look-at-the-sequence">Minimalist Architecture Design ‚Äî Details Look at the Sequence</h2>
<blockquote>
<p>Programming = Data structures + Algorithms + Control flow</p></blockquote>
<p>Before turning design into code, the last important step is nailing the details. For stakeholders and decision makers this step may not matter much, but for the implementers (the dev team) it directly affects delivery quality and timeline.</p>
<p>I think details should be captured in <strong>sequence diagrams</strong>.</p>
<p>We often use two kinds of diagrams for details: <mark>flowcharts and sequence diagrams</mark>. They have a lot in common, but I prefer sequence diagrams because they show order and make the boundaries and interactions between systems clear.</p>
<p>My rule of thumb: one sequence diagram per use case.</p>
<h3 id="example-3">Example</h3>
<p>Example from an official AWS blog:</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202307/aws-seq.png" alt="Header-based API Gateway versioning with CloudFront"  />


</p>
<p><small>via <a href="https://aws.amazon.com/blogs/architecture/sequence-diagrams-enrich-your-understanding-of-distributed-architectures/">AWS Architecture Blog</a></small></p>
<p>The diagram shows a sequence for using CloudFront in AWS: how requests flow across systems and how various error cases are handled.</p>
<h3 id="summary-3">Summary</h3>
<p>A few tips for sequence diagrams:</p>
<ul>
<li>User action is the trigger</li>
<li>System boundaries must be clear</li>
<li>Request and response = synchronous</li>
<li>Request without response = asynchronous</li>
</ul>
<p>Usually, once the sequence diagram is solid, you can hand off to the team with confidence. Without it, you rely entirely on collaboration and trust.</p>
<p>Deliverables: sequence diagram, API docs (OpenAPI/Swagger), frontend service generation (if applicable).</p>
<h2 id="minimalist-architecture-design--wrap-up">Minimalist Architecture Design ‚Äî Wrap-up</h2>
<p>By this point we haven‚Äôt written code yet, but we know what to do and what it will look like. We have class structure, API definitions, frontend service generation, etc. Multiple teams can work in parallel without obvious bottlenecks.</p>
<ul>
<li>‚úÖ Problem defined</li>
<li>‚úÖ Approach chosen</li>
<li>‚úÖ Class structure, API definitions</li>
<li>‚úÖ Server-side code generation</li>
<li>‚úÖ Flow agreed</li>
<li>‚úÖ About 1/3 of reporting material</li>
<li>‚úÖ About 1/2 of tech talk material</li>
</ul>
<p>If you need to report later, you already have about one third of the content. If you need to write a tech talk, you have about half.</p>
<p>If the project is a simple CRUD app, there usually aren‚Äôt many hard parts.</p>
<p>If it‚Äôs a data-intensive application (DIA), you need to design and implement storage and think about consistency and concurrency. For a complex system, you also need to check for uncertainty at the boundaries between systems. If you have sync challenges (e.g. framework changes, communication layer changes), de-risk early. (I don‚Äôt think doing tech upgrades and feature development in parallel is wise.)</p>
<h2 id="extra--drawing-tools">Extra ‚Äî Drawing Tools</h2>
<p>I have my own set of drawing tools for architecture diagrams, flowcharts, etc. P.S. I even design logos for my products‚Äîmaybe I‚Äôve always wanted to be a designer üôÇ</p>
<p>As an engineer, you should build your own drawing UI kit, get good at it, and put together a toolbox so you can turn ideas in your head into documents quickly.</p>
<p>My toolkit is fairly rich. For architecture diagrams:</p>
<ul>
<li>Block diagrams
<ul>
<li>OmniGraffle (paid, complex, polished)</li>
<li>Excalidraw (simple, casual)</li>
</ul>
</li>
<li>Deployment diagrams
<ul>
<li>Excalidraw</li>
</ul>
</li>
<li>Mind maps
<ul>
<li>SimpleMind (paid)</li>
<li>XMind (paid)</li>
</ul>
</li>
</ul>
<p>For engineering design (UML):</p>
<ul>
<li>Use cases
<ul>
<li>Yuque drawing</li>
<li>PlantUML (Yuque can render it)</li>
</ul>
</li>
<li>Sequence diagrams
<ul>
<li>PlantUML</li>
</ul>
</li>
<li>State diagrams
<ul>
<li>Yuque</li>
</ul>
</li>
<li>ER diagrams
<ul>
<li>Excalidraw</li>
</ul>
</li>
<li>Gantt charts
<ul>
<li>PlantUML</li>
</ul>
</li>
</ul>
<p>Shameless plug: I maintain <a href="https://excalidraw.alswl.com/">Excalidraw (Fork)</a>, with Chinese handwriting fonts and consistent style.</p>
<h2 id="extra--the-hard-way">Extra ‚Äî the Hard Way</h2>
<p>We started from a simple, practical architecture design flow. If you‚Äôre the curious type, that may not be enough‚Äîthere‚Äôs still the 20% of complex cases. Here are some keywords and book recommendations to go deeper:</p>
<ul>
<li>Principles</li>
<li>Philosophy</li>
<li>Ideas</li>
<li>Laws</li>
<li>Methodology</li>
<li>Case studies</li>
</ul>
<p>Some books that help:</p>
<ul>
<li>Business architecture
<ul>
<li><a href="https://book.douban.com/subject/1792387/">Applying UML and Patterns - Craig Larman</a></li>
<li><a href="https://book.douban.com/subject/5344973/">Domain-Driven Design - Eric Evans</a></li>
</ul>
</li>
<li>Technical architecture
<ul>
<li><a href="https://book.douban.com/subject/30468597/">Refactoring - Martin Fowler</a></li>
<li><a href="https://book.douban.com/subject/4199741/">Clean Code - Robert C. Martin</a></li>
</ul>
</li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>Pragmatic web API guidlines</title>
      <link>https://en.blog.alswl.com/2023/04/web-api-guidelines/</link>
      <pubDate>Mon, 03 Apr 2023 11:34:18 +0800</pubDate>
      <guid>https://en.blog.alswl.com/2023/04/web-api-guidelines/</guid>
      <description>&lt;p&gt;When starting to create a new system, or participating in a new team or project, there is a simple but profound question: Is there a design specification for the API of this system (Web Server)?&lt;/p&gt;
&lt;p&gt;




&lt;img loading=&#34;lazy&#34; src=&#34;https://en.blog.alswl.com/images/202304/pyramid.png&#34; alt=&#34;pyramid&#34;  /&gt;


&lt;/p&gt;
&lt;p&gt;&lt;small&gt;image by stable difussion, prompt by alswl&lt;/small&gt;&lt;/p&gt;
&lt;p&gt;This issue has bothered me for a long time, starting during my school days, and every time I needed to communicate and discuss with my team members.
From the initial free style to the later REST, I often referenced &lt;a href=&#34;https://docs.github.com/en/rest?apiVersion=2022-11-28&#34;&gt;Github v3&lt;/a&gt; to the project team and the
Foursqure API (no longer accessible, exposing age) documentation.
However, in practice, there are still cases where there is a mismatch with the actual work or the common company specification.
This is when I need to do some additional work. Eventually, I will write a brief &lt;code&gt;DEVELOPMENT.md&lt;/code&gt; document to describe the design solution.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>When starting to create a new system, or participating in a new team or project, there is a simple but profound question: Is there a design specification for the API of this system (Web Server)?</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202304/pyramid.png" alt="pyramid"  />


</p>
<p><small>image by stable difussion, prompt by alswl</small></p>
<p>This issue has bothered me for a long time, starting during my school days, and every time I needed to communicate and discuss with my team members.
From the initial free style to the later REST, I often referenced <a href="https://docs.github.com/en/rest?apiVersion=2022-11-28">Github v3</a> to the project team and the
Foursqure API (no longer accessible, exposing age) documentation.
However, in practice, there are still cases where there is a mismatch with the actual work or the common company specification.
This is when I need to do some additional work. Eventually, I will write a brief <code>DEVELOPMENT.md</code> document to describe the design solution.</p>
<p>But I&rsquo;ve always had more ideas for that document, and it&rsquo;s not quite good enough. So, I wanted to put together a <mark>Simple and Pragmatic</mark> Web API best practice, which is this article.</p>
<h2 id="why-we-need-api-uniformity-specifications">Why We Need API Uniformity Specifications</h2>
<p>The problem seems obvious, but a deeper analysis involves teamwork efficiency and engineering design philosophy.</p>
<p>API (Application Programming Interface) is the bridge between different software systems to interact with each other. When communicating between different software systems, the
APIs allow data transfer and processing in a standardized way, enabling the integration of various applications.</p>
<p>When we start writing API documentation, a paradigm (Design Pattern) emerges, whether it is explicit or implicit, whether
Whether it is one set for each or a common set. This is just like when we use a unified USB interface, unification reduces costs and avoids possible errors. Specifically, there are several reasons for this:</p>
<ul>
<li>Ease of understanding and efficiency: service providers and consumers use a unified form, structure and usage, and a unified production-consumption protocol, thus reducing communication costs.</li>
<li>Expert experience: It contains best engineering practices with corresponding solutions for common scenarios, avoiding the need for everyone to rethink the entire API system.
For example, how do you handle API caching? How to perform authentication? How to handle data formatting?</li>
<li>Extensibility: extensibility require stable protocols, protocols are abstract and implementation-independent, and not everyone has them
The ability to design uncertainty-oriented systems, and some widely used technologies plan for a wider range of scenarios.</li>
</ul>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202304/image-20230430225520666.png" alt="why"  />


</p>
<p><small>image by alswl</small></p>
<p>While it is true that there are some costs associated with the use of a unified specification that requires framework understanding and promotion, I believe that in most scenarios
the benefits of a unified specification far outweigh these costs.</p>
<p>However, not all cases require consideration of the API specification. For short lifecycle projects, internal projects and products with a very small impact
specifications may not require much attention. In addition, in some special business scenarios, the
The underlying protocol may change, and the existing specification may no longer be applicable. But even so, I still recommend redrafting a new specification, rather than abandoning it.</p>
<h2 id="principles-of-rules">Principles of rules</h2>
<p>When developing API specifications, we should follow some basic principles to deal with technical differences, and I have summarized three principles that have gained wide acceptance:</p>
<ul>
<li>Simplicity: Simplicity is the most direct and effective strategy to resist complexity, using the principle of simplicity to reduce complexity and avoid the breeding and proliferation of complexity;</li>
<li>Consistency: uniform design patterns and continuity of design styles help reduce engineering costs and the psychological burden on engineers;</li>
<li>follow reality: follow the abstractions and layering of existing engineering domains (e.g. HTTP, REST, RBAC, OIDC, etc.) and do not invent new concepts of your own.
Always think about whether the problem is the only one you have encountered (the answer is definitely no).</li>
</ul>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202304/image-20230430225710666.png" alt="principle"  />


</p>
<p><small>image by alswl</small></p>
<h2 id="does-rest-work-or-not">Does REST work or not?</h2>
<p>The <a href="https://en.wikipedia.org/wiki/Representational_state_transfer">RESTful API</a> has become a popular protocol in the Web API space.
Its broad applicability and reach stems from its binding to the HTTP protocol, which allows RESTful APIs to easily interact with existing Web technologies. If you are not familiar with REST, you can check out [Yifeng Ruan&rsquo;s
You can check out <a href="https://www.ruanyifeng.com/blog/2014/05/restful_api.html">Yifeng Ruan&rsquo;s RESTful API Design Guide</a> and
<a href="https://www.oschina.net/translate/best-practices-for-a-pragmatic-restful-api?print">Best Practices for RESTful API Design</a>.</p>
<p>REST is a high maturity protocol, which <a href="https://martinfowler.com/articles/richardsonMaturityModel.html#level0">Leonard Richardson</a>
describes it as having four levels of maturity:</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202304/rest-four-level.png" alt="rest-four-level"  />


</p>
<p><small>image by alswl</small></p>
<ol>
<li>The Swamp of POX, using HTTP to host the Legacy protocol (XML)</li>
<li>Resources: using resource abstraction</li>
<li>HTTP Verbs: using rich HTTP Verbs</li>
<li>Hypermedia Controls: API resource integration using <code>rel</code> links, <a href="https://jsonapi.org/">JSON:API</a> is the pinnacle of performance</li>
</ol>
<p>The core strength of REST is that</p>
<ul>
<li>It takes full advantage of the design of the HTTP Protocol (HTTP Protocol)</li>
<li>It has excellent identification of resources</li>
<li>It is designed with complete manipulation of resources (Manipulation of resources)</li>
<li>It has Self-descriptive messages</li>
<li>It supports multiple forms of presentation (hypermedia as the engine of application state)</li>
</ul>
<p>However, <mark>REST is not a specific protocol or specification, but a style philosophy</mark>. While REST defines rules and principles such as the identification of resources, unified interfaces, stateless communication, etc., it does not prescribe a specific protocol or specification.
it does not prescribe a specific way to implement them. As a result, in practice, different teams may have different understandings and practices, leading to inconsistencies and portability of the API.
This leads to inconsistency and reduced maintainability of the API.</p>
<p>In addition, REST has a number of limitations and drawbacks:</p>
<ul>
<li>Not all requests can be described by resources, such as the login (<code>/login</code>) operation, which is very convoluted when converted to <code>session</code>;
The same problem arises for operations like money transfers, where the limited number of HTTP verbs cannot support all business scenarios.</li>
<li>REST does not provide a clear solution to the inevitable problems such as paging, specific structure of the return body, error handling and authentication, etc.</li>
<li>For complex queries (such as Search Search), the query parameters of the RESTful API can become very complex and difficult to maintain.</li>
</ul>
<p>Therefore, although the REST style is a good guideline, the specific implementation needs to be combined with specific business requirements and technical features to make some trade-offs in order to achieve a good API design.
Finally, do we need a Web API design specification that follows the REST style? I think REST can solve 90% of the problems, but there is still 10% need to specify the details.</p>
<h2 id="web-api-specification-multiple-choice-questions">Web API specification multiple choice questions</h2>
<p>Since our protocol is based on HTTP and REST design, we will base our discussion on the four core parts of an HTTP request: URL, Header, Request and Response.
These are: URL, Header, Request and Response.</p>
<h3 id="url-best-practices">URL Best Practices</h3>
<p>My inspiration for URL design came from <a href="https://guides.rubyonrails.org/routing.html">Ruby on Rails</a>.
Before that, I always instinctively put model information on top of URLs, but in reality good URL design should be a plan for the information structure of the system.
Therefore, URL design should consider not only the API, but also the user-oriented Web URL.</p>
<p>To achieve good URL design, I have summarized the following rules:</p>
<ul>
<li>Locate resources (this answers the question of whether paging should be in the Header)</li>
<li>Self-explanatory (readable, the URL itself contains the core information)</li>
<li>Security (can not contain user authentication information, OAuth spent a lot of effort to understand this, anti-forgery)</li>
</ul>
<p>Typically, the URL model is as follows:</p>
<p><code>/$(prefix)/$(module)/$(model)/$(sub-model)/$(verb)?$(query)#${fragment}</code></p>
<p>where Prefix may be the version of the API, or it may be a special qualification, as some companies rely on for access layer triage;
Module is a business module, which can also be omitted; Model is a model; SubModel is a submodel, which can be omitted;
Verb is a verb, which can also be omitted; Query is a request parameter; Fragment is an HTTP primitive Fragment.</p>
<p>It is important to note that not all components are required to appear. For example, fields such as SubModel and Verb can
be allowed to be hidden in different URL styles.</p>
<p><strong>Design Style Options</strong></p>
<p>Note: <strong>Please note that there is no association between Scenario A / B / C and no association above or below each line</strong></p>
<table>
  <thead>
      <tr>
          <th>Problem</th>
          <th>Explanation (see separate analysis below)</th>
          <th>Option A</th>
          <th>Option B</th>
          <th>Option C</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Dos API path&rsquo;s prefix</td>
          <td></td>
          <td><code>/apis</code></td>
          <td><code>/api</code></td>
          <td>second-level domain</td>
      </tr>
      <tr>
          <td>Does the path contain the API version</td>
          <td><strong>Version advantage in URLs</strong></td>
          <td>‚úÖ</td>
          <td>üö´</td>
          <td></td>
      </tr>
      <tr>
          <td>Does path contain a group</td>
          <td></td>
          <td>‚úÖ</td>
          <td>üö´</td>
          <td></td>
      </tr>
      <tr>
          <td>Whether path contains action</td>
          <td><strong>HTTP Verb is not enough</strong></td>
          <td>‚úÖ</td>
          <td>üö´ (pure REST)</td>
          <td>Depends (include if HTTP Verb CRUD cannot be satisfied)</td>
      </tr>
      <tr>
          <td>Model ID form</td>
          <td><strong>Readable Stable Identity explained</strong></td>
          <td>Self-incrementing ID</td>
          <td>GUID</td>
          <td><mark>Readable Stable ID</mark></td>
      </tr>
      <tr>
          <td>Model singular or plural in URL</td>
          <td></td>
          <td>Singular</td>
          <td>Plural</td>
          <td>List Plural, One-Way Singular</td>
      </tr>
      <tr>
          <td>Is the resource one-level (tiled) or multi-level (nested)</td>
          <td><strong>Explanation of one-level and multi-level</strong></td>
          <td>One-level (tiled)</td>
          <td>Multi-level (nested)</td>
          <td></td>
      </tr>
      <tr>
          <td>How is search implemented, standalone API (<code>/models/search</code>) or list-based <code>/models/</code> API</td>
          <td></td>
          <td>standalone</td>
          <td>list-based</td>
          <td></td>
      </tr>
      <tr>
          <td>Does it have an Alias URL</td>
          <td><strong>Alias URL explanation</strong></td>
          <td>‚úÖ</td>
          <td>üö´</td>
          <td></td>
      </tr>
      <tr>
          <td>Does the model in the URL allow abbreviations (or refinements)</td>
          <td><strong>Model abbreviations explained</strong></td>
          <td>‚úÖ</td>
          <td>üö´</td>
          <td></td>
      </tr>
      <tr>
          <td>Hyphenation of multiple words of the model in the URL</td>
          <td></td>
          <td><code>-</code></td>
          <td><code>_</code></td>
          <td>Camel</td>
      </tr>
      <tr>
          <td>Whether to distinguish between Web API and Open API (non-browser oriented)</td>
          <td></td>
          <td>‚úÖ</td>
          <td>üö´</td>
          <td></td>
      </tr>
  </tbody>
</table>
<p><strong>Version advantage in URLs</strong></p>
<p>We follow the principle of consistency when designing URLs; the same URL is used to access the same resource, regardless of identity or state.
This is also the basic principle of Uniform Resource Location. While we can accept different content formats (e.g. JSON / YAML / HTML / PDF / etc.)
but we want the location of the resource to be unique.</p>
<p>However, the question is, should the same resource be reflected in the URL for rendering between versions? This depends on whether the designer considers versioning to be in the realm of location information.</p>
<p>According to the RFC design, in addition to the URL there is <a href="https://en.wikipedia.org/wiki/Uniform_Resource_Name">URN (Uniform Resource Name)</a>.
The latter is used to identify the resource, while the URL points to the resource address. In practice, URNs are not so widely used that URIs are almost equivalent to URLs.</p>
<p><strong>HTTP Verb is not enough</strong></p>
<p>In REST design, we need to operate on resources using HTTP verbs like GET / POST / PUT / DELETE / PATCH / HEAD.
For example, using the API <code>GET /apis/books</code> to view book listings is natural and reasonable.
However, when it comes to performing an action like &ldquo;borrow a book
we don&rsquo;t have a suitable verb (BORROW) to represent it. In this case, there are two possible options:</p>
<ol>
<li>use the POST method with a custom verb, such as <code>POST /apis/books/borrow</code>, for the action of borrowing a book;</li>
<li>creating a book borrow log, using a resource add method to structure the non-existent action, e.g. <code>POST /apis/books/borrow-log/</code>;</li>
</ol>
<p>This issue comes up a lot in complex scenarios such as user login (<code>POST /api/auth/login</code> vs <code>POST /api/session</code>) and account transfers (vs transfer record creation), etc.
<mark>API abstract or concrete, there is always an explanation of the business. </mark> We can&rsquo;t simply generalize all of our business to CRUD.
Rather, we need to divide the business wisely to make it clearer and more understandable to users.</p>
<p>When designing, we can consider whether we need to create a corresponding button for each API to make it easier for users to do so.
If there is only one API named <code>/api/do</code> and all the services are bound to it, although technically possible, this design does not meet the business requirements.
Each layer of abstraction is designed to standardize the solution to a particular problem, and the TCP L7 design is a reflection of this philosophy.</p>
<p><strong>Readable Stable Identity explained</strong></p>
<p>When marking a resource, we typically have several options:</p>
<ul>
<li>Use ID: IDs are usually bound to database self-incrementing IDs.</li>
<li>Use a GUID: such as a UUID, although less precise.</li>
<li>Use Readable Stable Identity: Usually identified by name, UID, or a specific ID such as a host name, IP address, or serial number.
This identifier is required to be stable and globally unique, which is useful in internal systems.</li>
</ul>
<p>I have a personal design tip: use a slug of the form <code>${type}/${type-id}</code> to describe an identifier.
For example <code>hostname/abc.sqa</code> or <code>ip/172.133.2.1</code>.
This design approach provides a good balance between readability and uniqueness.</p>
<blockquote>
<p>A slug is a human-readable, unique identifier, used to identify a resource instead of a less human-readable identifier like an id .</p></blockquote>
<p>from <a href="https://itnext.io/whats-a-slug-f7e74b6c23e0">What&rsquo;s a slug. and why would I use one? | by Dave Sag</a></p>
<p>PS: At the end of the article I&rsquo;ll also introduce an Apple Music solution that combines the ID / Readable / Stable features.</p>
<p><strong>Explanation of one-level and multi-level</strong></p>
<p>The hierarchical design of URLs can be based on modeling, or a straightforward single-level structure can be used. specific problem solving approach.
For example, when designing user-owned books, one can choose a multi-level structure <code>/api/users/foo/books</code> or a one-level structure <code>/api/books?owner=foo</code>.</p>
<p>Both options are technically possible, <mark>the former respecting the attribution of the model, and the latter focusing on the simplicity of the URL structure</mark>.</p>
<p>A multi-level structure is more intuitive, but also needs to address the issue of possible multiple ways of organization, such as books in a library organized by author or category?
In this case, consider making the attribution of models explicit in a multi-level structure
For example <code>/api/author/foo/books</code> (based on authors) or <code>/api/category/computer/books</code> (based on categories).</p>
<p><strong>Alias URL explanation</strong></p>
<p>For some frequently used URLs, although they can be designed according to URL rules, we can still design a more concise URL that
to facilitate user presentation and use. This design is especially common for Web URLs. For example, the API for a library&rsquo;s most popular books:</p>
<pre tabindex="0"><code># Original URL
https://test.com/apis/v3/books?sort=hot&amp;limit=10

# Alias URL
https://test.com/apis/v3/books/hot
</code></pre><p><strong>Model abbreviations explained</strong></p>
<p>Often, when modeling resources, longer names are used to name them, for example a book index might be named <code>BookIndex</code> instead of <code>Index</code>.
When rendering in URLs, since the URL prefix of <code>/book/book-index</code> contains Book, we can reduce the layer of description and
We can make the URL more concise, for example by using <code>/book/index</code>. This technique is very common in Web URL design.</p>
<p>There is also a strategy of model abbreviation, which provides a complete set of alias registration schemes. aliases that are globally unique.
For example, in Kubernetes, <a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.26/#deployment-v1-apps">Deployment</a>
is a common naming, while <code>apps/v1/Deployment</code> is the full name by adding a Group restriction.
There is also a shorthand for <code>deploy</code>. This mechanism relies on Kubernetes&rsquo; API Schema system for registration and work.</p>
<h3 id="header-best-practices">Header Best Practices</h3>
<p>We often overlook the importance of the Header. In fact, the selection of HTTP verbs, HTTP status codes, and various authentication logic (e.g., cookies / Basic Auth / Berear Token) all depend on the design of the Header.
In fact, the selection of HTTP verbs, HTTP status codes, and various identity verification logic (e.g., Cookie / Basic Auth / Berear Token) all depend on the design of the Header.</p>
<p><strong>Design style selection</strong></p>
<table>
  <thead>
      <tr>
          <th>Problem</th>
          <th>Explanation (see separate analysis below)</th>
          <th>Option A</th>
          <th>Option B</th>
          <th>Option C</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Are all verbs using POST</td>
          <td><strong>About only using POST</strong></td>
          <td>‚úÖ</td>
          <td>üö´</td>
          <td></td>
      </tr>
      <tr>
          <td>Is the Modify action POST or PATCH?</td>
          <td></td>
          <td>POST</td>
          <td>PATCH</td>
          <td></td>
      </tr>
      <tr>
          <td>HTTP status return code</td>
          <td><strong>2XX family</strong></td>
          <td>Make full use of HTTP Status</td>
          <td>Use only core status (200 404 302, etc.)</td>
          <td>Use only 200</td>
      </tr>
      <tr>
          <td>Is using rate limiter system</td>
          <td></td>
          <td>‚úÖ 429</td>
          <td>üö´</td>
          <td></td>
      </tr>
      <tr>
          <td>Is using cache system</td>
          <td></td>
          <td>‚úÖ  ETag / Last Modify</td>
          <td>üö´</td>
          <td></td>
      </tr>
      <tr>
          <td>Is validate UserAgent</td>
          <td></td>
          <td>‚úÖ</td>
          <td>üö´</td>
          <td></td>
      </tr>
      <tr>
          <td>Is validate  Referrral</td>
          <td></td>
          <td>‚úÖ</td>
          <td>üö´</td>
          <td></td>
      </tr>
  </tbody>
</table>
<p><strong>About only using POST</strong></p>
<p>Some novices (or those who consider themselves experienced) may come to the erroneous conclusion that, with the exception of GET requests
all HTTP requests should use the POST method. Some even demand that <a href="https://www.zhihu.com/question/336797348">all actions (even read-only requests) should use the POST method</a>.
This argument is often supported on the grounds of &ldquo;simple consistency&rdquo;, &ldquo;cache avoidance&rdquo;, or &ldquo;operator requirements&rdquo;.</p>
<p>However, it is important to understand the original design of the HTTP method: it is used to describe the type of resource manipulation that gives rise to a number of issues including caching, security, and idempotency.
In relatively simple scenarios, omitting this layer of abstraction really doesn&rsquo;t pose much of a problem, but once you get into the complexities of the domain, the
Using this layer of abstraction for HTTP methods becomes very important. <mark>Whether this follows the standard or not will determine whether you get the benefits of standardization</mark>.
The analogy is like a new phone manufacturer that can choose not to use the USB TypeC interface.
It&rsquo;s technically possible, but it also loses a lot of standardization support and mental agreement.</p>
<p>I especially like one <a href="https://www.zhihu.com/people/huixiong-19">Knowing user</a>&rsquo;s
<a href="https://www.zhihu.com/question/336797348/answer/2198634068">comment</a>: &ldquo;<mark>Routing hasn&rsquo;t gone away, it&rsquo;s just shifted</mark>.</p>
<p><strong>2XX family</strong></p>
<p>The purpose of HTTP status codes is to indicate the result of communication between the client and the server. 2XX status code family means that the server has successfully received, understood, and processed the client request,
understood and processed the client request, and the response was successful. The following are common status codes in the 2XX family and their meanings:</p>
<ul>
<li>200 OK: The request was processed successfully and the server returned a response.</li>
<li>201 Created: The request has been successfully processed and a new resource has been created on the server.</li>
<li>202 Accepted: The request has been accepted by the server, but not yet executed. This status code is typically used for asynchronous processing.</li>
<li>204 No Content: The request was processed successfully, but the server did not return any response body content.</li>
</ul>
<p>The 2XX family of status codes indicates that the request has been successfully processed. These status codes let the client know explicitly that the request has been processed correctly so that it can proceed to the next step.</p>
<p>The need to use the 2XX family of status codes across the board depends on whether the client needs to be explicitly/displayed with information that
inform it of the next action. If it has been clearly described by other means (including documentation, verbal agreements)
then it is indeed possible to use 200 status codes across the board for return. But passing meaning based on behavior.
or document-based (or even verbal)? Is it more complex or more concise?</p>
<h3 id="request-best-practices">Request Best Practices</h3>
<p><strong>Design style selection</strong></p>
<table>
  <thead>
      <tr>
          <th>Problem</th>
          <th>Explanation (see separate analysis below)</th>
          <th>Option A</th>
          <th>Option B</th>
          <th>Option C</th>
          <th></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Whether complex parameters are put into Form Fields or a separate JSON Body</td>
          <td></td>
          <td>Form Fields</td>
          <td>Body</td>
          <td></td>
          <td></td>
      </tr>
      <tr>
          <td>Whether the subresource is a one-time query or an independent query</td>
          <td></td>
          <td>one-time</td>
          <td>independent</td>
          <td></td>
          <td></td>
      </tr>
      <tr>
          <td>Paging parameter storage</td>
          <td></td>
          <td>Header</td>
          <td>URL Query</td>
          <td></td>
          <td></td>
      </tr>
      <tr>
          <td>Paging parameter method</td>
          <td><strong>Explanation of paging method</strong></td>
          <td>Page based</td>
          <td>Offset based</td>
          <td>Continuation token</td>
          <td></td>
      </tr>
      <tr>
          <td>Paging Controllers</td>
          <td><strong>Paging controller explanation</strong></td>
          <td>Client</td>
          <td>Server</td>
          <td></td>
          <td></td>
      </tr>
  </tbody>
</table>
<p><strong>Explanation of paging methods</strong></p>
<p>The two most common types of paging we see are Page-based and Offset-based, which can be mapped by formula.
In addition, there exists a method called Continuation Token, which is similar in technique to Oracle&rsquo;s
<a href="https://stackoverflow.com/questions/241622/paging-with-oracle">rownum paging scheme</a>, using the parameter <code>start-from=? </code> to describe it.
While the advantages and disadvantages of Continuation Token are significant, using this approach allows sequential to be used as an alternative to random.</p>
<p><strong>Paging controls interpretation</strong>.</p>
<p>In some cases, we need to distinguish between Client Pagination and Server Pagniation.
Client Pagination means that the parameters of the next page are calculated by the client, while Server Pagination is a protocol such as <code>rel</code> or JSON.API returned by the server.
Using Server Pagniation avoids some problems, such as bulk blocking of some content, which may result in missing pages or white screens if client-side paging is used.</p>
<h3 id="response-best-practices">Response Best Practices</h3>
<p><strong>Design Style Selection</strong></p>
<table>
  <thead>
      <tr>
          <th>Problem</th>
          <th>Explanation (see separate analysis below)</th>
          <th>Option A</th>
          <th>Option B</th>
          <th>Option C</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td>Model presentation types</td>
          <td><strong>Several forms of models</strong></td>
          <td>Single model</td>
          <td>Multiple models</td>
          <td></td>
      </tr>
      <tr>
          <td>How large models contain sub-model models</td>
          <td><strong>Linking, sidecar, and embedding of models</strong></td>
          <td>Embedding</td>
          <td>Core model + multiple linked resource queries</td>
          <td>Linking</td>
      </tr>
      <tr>
          <td>Whether field returns are on-demand or grouped or unified</td>
          <td></td>
          <td>unified</td>
          <td>Use the <code>fields</code> field on demand</td>
          <td></td>
      </tr>
      <tr>
          <td>field presentation format</td>
          <td></td>
          <td>Snake</td>
          <td>Camel</td>
          <td></td>
      </tr>
      <tr>
          <td>Error code</td>
          <td></td>
          <td>No customization, use Message</td>
          <td>Custom</td>
          <td></td>
      </tr>
      <tr>
          <td>Error format</td>
          <td></td>
          <td>global uniform</td>
          <td>on-demand</td>
          <td></td>
      </tr>
      <tr>
          <td>Time Zone</td>
          <td></td>
          <td>UTC</td>
          <td>Local</td>
          <td>Local + TZ</td>
      </tr>
      <tr>
          <td>HATEOAS</td>
          <td></td>
          <td>‚úÖ</td>
          <td>üö´</td>
          <td></td>
      </tr>
  </tbody>
</table>
<p><strong>Several forms of models</strong></p>
<p>In API design, there are several definitions for how models should be represented. Although this is not a topic that must be discussed in the API specification, it is very important for API design.</p>
<p>I have divided the model presentation that models are often described into the following categories, which are not professionally defined and borrow some definitions from the Java context below.
These names will be called differently in different companies and even different teams:</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202304/models.png" alt="models"  />


</p>
<p><small>image by alswl</small></p>
<ul>
<li>Business Object (BO): the original business model</li>
<li>Data Object (DO): the model stored to the RDBMS, so it must be a flat field structure, sometimes a BO will correspond to multiple DOs</li>
<li>View Object (VO): the model presented to the presentation layer, only keep the information the user needs to see, such as sensitive information will be removed</li>
<li>Data Transfer Object (DTO): the model used to transfer in the RPC system, generally not much different from the original Model, depending on the different serialization systems will have differences
(such as the handling of enumerations)</li>
</ul>
<p>In addition, two other categories are often used: Rich Model and Tiny Model (please ignore the naming, it varies a lot from team to team):</p>
<ul>
<li>Rich Model: This model is used to describe a rich model, which contains almost all the data needed and allows nesting of sub-resources.</li>
<li>Tiny Model: is a compact model, often used in the list API to be used</li>
</ul>
<p><strong>Linking, sidecar, and embedding of models</strong></p>
<p>In API design, we often need to deal with cases where a model contains multiple submodels, such as a Book containing Comments.
For this case, there are usually three representations to choose from: Link, Side, and Embed.</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202304/models-with-children.png" alt="models-with-children"  />


</p>
<p><small>image by alswl</small></p>
<p>Linking (sometimes this URL is also hidden, based on an implicit protocol between client and server for requests):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;data&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;ÊúùËä±Â§ïÊãæ&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;relationships&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;comments&#34;</span><span class="p">:</span> <span class="s2">&#34;http://www.domain.com/book/42/comments&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;author&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;http://www.domain.com/author/È≤ÅËøÖ&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Sidecar:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;data&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;ÊúùËä±Â§ïÊãæ&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;relationships&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;comments&#34;</span><span class="p">:</span> <span class="s2">&#34;http://www.domain.com/book/42/comments&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;authors&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;http://www.domain.com/author/È≤ÅËøÖ&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">]</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;includes&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;comments&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="mi">91</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;author&#34;</span><span class="p">:</span> <span class="s2">&#34;ÂåøÂêç&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;content&#34;</span><span class="p">:</span> <span class="s2">&#34;ÈùûÂ∏∏Ê£í&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;authors&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;È≤ÅËøÖ&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;È≤ÅËøÖÂéüÂêçÂë®Ê†ë‰∫∫&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>Embedding:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;data&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;ÊúùËä±Â§ïÊãæ&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;comments&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="mi">91</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;author&#34;</span><span class="p">:</span> <span class="s2">&#34;ÂåøÂêç&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;content&#34;</span><span class="p">:</span> <span class="s2">&#34;ÈùûÂ∏∏Ê£í&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">],</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;authors&#34;</span><span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;name&#34;</span><span class="p">:</span> <span class="s2">&#34;È≤ÅËøÖ&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;description&#34;</span><span class="p">:</span> <span class="s2">&#34;È≤ÅËøÖÂéüÂêçÂë®Ê†ë‰∫∫&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h3 id="others">Others</h3>
<p>There are some other issues that are not converged in the four elements, but we often encounter them in engineering practice, and I will run them out:</p>
<p>**I&rsquo;m not in the HTTP protocol, what should I do? ** I&rsquo;m not in the HTTP protocol, what should I do?</p>
<p>Non-HTTP protocols are less commonly encountered in Web APIs, and the cost of creating a new set of protocols is too high. There are protocols that are introduced in certain areas.
For example, <a href="https://mqtt.org/">MQTT</a> in the IoT domain.</p>
<p>In addition, RPC is a wide-ranging concept that goes far beyond the protocol level.
Often we compare the transport protocols of HTTP and RPC, as well as serialization protocols.
I believe that much of the discussion in this paper is also of importance to the RPC community.</p>
<p>Some teams or individuals plan to use protocols that they create themselves, but my opinion is that self-built protocols should be avoided as much as possible, because it is very rare that there is a real need to create a protocol.
If a strong need does exist, then I would ask two questions: Have you read through the HTTP RFC document and the HTTP/2 RFC document?</p>
<p>**I&rsquo;m not a remote service (RPC / HTTP etc.), but what about the SDK? ** This article focuses on Web APIs (RPC/ HTTP etc.).</p>
<p>This article focuses on the design specifications of the Web API (HTTP) and some of the rules can be applied to RPC systems.
However, the basis of the discussion is based on Remote Service.
If you are an SDK developer, you will have two roles, possibly as a client communicating with a remote server, and as an SDK providing developer-oriented services.
You will also provide developer-facing interfaces as an SDK. For the latter, the following specifications can be used as a reference:</p>
<p>For the latter, you can refer to these specifications:</p>
<ul>
<li>Azure SDK Design Specifications <a href="https://azure.github.io/azure-sdk/general_design.html">General Guidelines: API Design | Azure SDKs</a></li>
<li>Posix API examples (e.g. File <a href="https://www.gnu.org/software/libc/manual/html_node/Low_002dLevel-I_002fO.html">Low-Level I/O (The GNU C Library)</a>)</li>
</ul>
<p><strong>Authentication Authentication Scheme</strong></p>
<p>In general, the Web API design will clearly describe the authentication and authentication system to be used.
It is important to distinguish between the concepts of &ldquo;authentication&rdquo; and &ldquo;authentication&rdquo;. The topic of &ldquo;authentication&rdquo; can be discussed in a separate section, so this paper will not cover this aspect.</p>
<p>In Web API design, common authentication methods include HTTP Basic Auth, OAuth2, and account password login.
In addition, HMac algorithm-based anti-replay and anti-tampering schemes are used for anti-tampering.</p>
<p><strong>Overlooked Topics</strong></p>
<p>In this discussion, I did not cover the following topics: asynchronous protocols (Web Sockets / Long Pulling / Round Trials), CORS, and security issues.
Although these topics are important, they will not be covered in this article.</p>
<p><strong>When to break the rules</strong></p>
<p>Some developers believe that rules are there to be broken. The reality is often so complex that it is difficult to discuss the details.
If a developer feels that a rule does not meet the actual need, there are two ways to handle it: change the rule or break it.
However, I prefer to discuss and update the rules, clarify where the specification is inadequate, and determine if there are special cases.
If a special case does need to be created, be sure to describe it in detail in the documentation, informing the successor and the consumer that it is a special case, explaining why the special case was created and how the special case responds.</p>
<h2 id="a-style-checklist">A style Checklist</h2>
<h3 id="github-style">Github style</h3>
<p>Github&rsquo;s API is one that I often refer to. It models its business domain very clearly, provides thorough documentation, and makes communication much less costly.
I mainly refer to the following two links:
API Definition <a href="https://docs.github.com/en/rest?apiVersion=2022-11-28">GitHub REST API documentation</a> and
a list of application-oriented APIs [Endpoints available for GitHub Apps](<a href="https://docs.github.com/en/rest/overview/endpoints-available-for-github-apps">https://docs.github.com/en/rest/overview/endpoints-available-for-github-apps</a>? apiVersion=2022-11-28)
This list includes almost all of Github&rsquo;s APIs.</p>
<table>
  <thead>
      <tr>
          <th>Problem</th>
          <th>Choice</th>
          <th>Comment</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>URL</strong></td>
          <td>¬†</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Dos API path&rsquo;s prefix</td>
          <td>second-level domain</td>
          <td><a href="https://api.github.com">https://api.github.com</a></td>
      </tr>
      <tr>
          <td>Does the path contain the API version</td>
          <td>üö´</td>
          <td>Header <code>X-GitHub-Api-Version</code> <a href="https://docs.github.com/en/rest/overview/api-versions?apiVersion=2022-11-28">API Versions</a></td>
      </tr>
      <tr>
          <td>Does path contain a group</td>
          <td>üö´</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Whether path contains action</td>
          <td>Depends (include if HTTP Verb CRUD cannot be satisfied)</td>
          <td>sample: /repos/{owner}/{repo}/pulls/{pull_number}/merge¬†POST /repos/{owner}/{repo}/releases/generate-notes</td>
      </tr>
      <tr>
          <td>Model ID form</td>
          <td>Readable Stable Identity</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Model singular or plural in URL</td>
          <td>Plural</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Is the resource one-level (tiled) or multi-level (nested)</td>
          <td>multi-level</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>How is search implemented, standalone API (/models/search) or list-based¬†/models/¬†API</td>
          <td>standalone</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Does it have an Alias URL</td>
          <td>?</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Does the model in the URL allow abbreviations (or refinements)</td>
          <td>üö´</td>
          <td>No obvious information is seen, and it is not required based on the multilevel model, but it exists GET /orgs/{org}/actions/required_workflows</td>
      </tr>
      <tr>
          <td>Hyphenation of multiple words of the model in the URL</td>
          <td>-¬†and¬†_</td>
          <td>GET /repos/{owner}/{repo}/git/matching-refs/{ref}¬†vs¬†GET /orgs/{org}/actions/required_workflows</td>
      </tr>
      <tr>
          <td>Whether to distinguish between Web API and Open API (non-browser oriented)</td>
          <td>üö´</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td><strong>Header</strong></td>
          <td>¬†</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Are all verbs using POST¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>üö´</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Is the Modify action POST or PATCH?</td>
          <td>PATCH</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>HTTP status return code ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>Leverage HTTP Status</td>
          <td>Commonly used, including rate limiter</td>
      </tr>
      <tr>
          <td>Is using rate limiter system¬† ¬† ¬† ¬†</td>
          <td>‚úÖ 429</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Is using cache system ¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>‚úÖ ETag / Last Modify</td>
          <td><a href="https://docs.github.com/en/rest/overview/resources-in-the-rest-api?apiVersion=2022-11-28#client-errors">Resources in the REST API#client-errors</a></td>
      </tr>
      <tr>
          <td>Is validate UserAgent ¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>‚úÖ</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Is validate¬† Referrral¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>üö´</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td><strong>Request</strong></td>
          <td>¬†</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Whether complex parameters are put into Form Fields or a separate JSON Body</td>
          <td>Body</td>
          <td>for example,¬†<a href="https://docs.github.com/en/rest/pulls/pulls?apiVersion=2022-11-28#create-a-pull-request">Pulls#create-a-pull-request</a></td>
      </tr>
      <tr>
          <td>Whether the subresource is a one-time query or an independent query ¬† ¬† ¬† ¬†</td>
          <td>one-time</td>
          <td>Judging from Pulls</td>
      </tr>
      <tr>
          <td>Paging parameter storage¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>URL Query</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Whether complex parameters are put into Form Fields or a separate JSON Body</td>
          <td>Page</td>
          <td><a href="https://docs.github.com/en/rest/guides/using-pagination-in-the-rest-api?apiVersion=2022-11-28">Using pagination in the REST API</a></td>
      </tr>
      <tr>
          <td>Whether the subresource is a one-time query or an independent query ¬† ¬† ¬† ¬†</td>
          <td>Server</td>
          <td><a href="https://docs.github.com/en/rest/guides/using-pagination-in-the-rest-api?apiVersion=2022-11-28">Using pagination in the REST API</a></td>
      </tr>
      <tr>
          <td><strong>Response</strong></td>
          <td>¬†</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Model presentation types¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>Multi</td>
          <td>For example, the details in Commits and Parent <a href="https://docs.github.com/en/rest/commits/commits?apiVersion=2022-11-28">Commits</a></td>
      </tr>
      <tr>
          <td>How large models contain sub-model models ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>Core Model + Multiple Linked Resource Queries</td>
          <td>Not explicitly stated, inferred from several core APIs</td>
      </tr>
      <tr>
          <td>Whether field returns are on-demand or grouped or unified</td>
          <td>Unified</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>field presentation format ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>Snake</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Error code¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>None</td>
          <td><a href="https://docs.github.com/en/rest/overview/resources-in-the-rest-api?apiVersion=2022-11-28#client-errors">Resources in the REST API#client-errors</a></td>
      </tr>
      <tr>
          <td>Error format¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>Global Harmonization</td>
          <td><a href="https://docs.github.com/en/rest/overview/resources-in-the-rest-api?apiVersion=2022-11-28#client-errors">Resources in the REST API#client-errors</a></td>
      </tr>
      <tr>
          <td>Time Zone ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>MultiÔºàISO 8601 &gt; Time-Zone Header &gt; User Last &gt; UTCÔºâ</td>
          <td><a href="https://docs.github.com/en/rest/overview/resources-in-the-rest-api?apiVersion=2022-11-28#timezones">Resources in the REST API#Timezones</a></td>
      </tr>
  </tbody>
</table>
<h3 id="azure-style">Azure style</h3>
<p>Azure&rsquo;s API design follows [api-guidelines/Guidelines.md at master - microsoft/api-guidelines](<a href="https://github.com/Microsoft/api-guidelines/blob/">https://github.com/Microsoft/api-guidelines/blob/</a> master/Guidelines.md).
This article is schematic, and there is also a practical guide at [Best practices in cloud applications](<a href="https://learn.microsoft.com/en-us/azure/architecture/best-practices/index">https://learn.microsoft.com/en-us/azure/architecture/best-practices/index</a> -best-practices)
and <a href="https://learn.microsoft.com/en-us/azure/architecture/best-practices/api-design">Web API design best practices</a>.</p>
<p>Note that Azure&rsquo;s product line is much richer than Github, and some APIs do not follow Azure&rsquo;s own specifications.
When looking for examples, I mainly refer to
<a href="https://learn.microsoft.com/en-us/rest/api/?view=Azure">REST API Browser</a>, the
<a href="https://learn.microsoft.com/en-us/rest/api/storageservices/">Azure Storage REST API Reference</a>.
If the specific implementation conflicts with the Guidelines.md, I will use the Guidelines.md conclusion.</p>
<table>
  <thead>
      <tr>
          <th>Problem</th>
          <th>Choice</th>
          <th>Comment</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>URL</strong></td>
          <td>¬†</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Dos API path&rsquo;s prefix</td>
          <td>Second level domain</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Does the path contain the API version</td>
          <td>üö´</td>
          <td>x-ms-version</td>
      </tr>
      <tr>
          <td>Does path contain a group</td>
          <td>‚úÖ</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Whether path contains action</td>
          <td>üö´Ôºü</td>
          <td>Not explicitly stated, but there is a tendency to use the comp parameter for actions that keep the URL RESTful Reference Lease Container (REST API) - Azure Storage</td>
      </tr>
      <tr>
          <td>Model ID form</td>
          <td>Readable Stable Identity</td>
          <td><a href="https://github.com/Microsoft/api-guidelines/blob/master/Guidelines.md#73-canonical-identifier">Guidelines.md#73-canonical-identifier</a></td>
      </tr>
      <tr>
          <td>Model singular or plural in URL</td>
          <td>Plural</td>
          <td><a href="https://github.com/Microsoft/api-guidelines/blob/master/Guidelines.md#93-collection-url-patterns">Guidelines.md#93-collection-url-patterns</a></td>
      </tr>
      <tr>
          <td>Is the resource one-level (tiled) or multi-level (nested)</td>
          <td>one-level (tiled) / multi-level (nested)</td>
          <td><a href="https://learn.microsoft.com/en-us/azure/architecture/best-practices/api-design#define-api-operations-in-terms-of-http-methods">api-design#define-api-operations-in-terms-of-http-methods</a>, note MS has comp=? parameter, which is used to handle special commands</td>
      </tr>
      <tr>
          <td>How is search implemented, standalone API (/models/search) or list-based¬†/models/¬†API</td>
          <td>?</td>
          <td>Tends to be list-based because of the heavy use of comp= this URL Param for subcommands such as <a href="https://learn.microsoft.com/en-us/rest/api/storageservices/incremental-copy-blob">Incremental Copy Blob (REST API) - Azure Storage</a></td>
      </tr>
      <tr>
          <td>Does it have an Alias URL</td>
          <td>?</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Does the model in the URL allow abbreviations (or refinements)</td>
          <td>?</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Hyphenation of multiple words of the model in the URL</td>
          <td>Camel</td>
          <td><a href="https://learn.microsoft.com/en-us/rest/api/storagemover/job-runs/list?tabs=HTTP">Job Runs - List - REST API (Azure Storage Mover)</a></td>
      </tr>
      <tr>
          <td>Whether to distinguish between Web API and Open API (non-browser oriented)</td>
          <td>üö´</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td><strong>Header</strong></td>
          <td>¬†</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Are all verbs using POST¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>üö´</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Is the Modify action POST or PATCH?</td>
          <td>PATCH</td>
          <td><a href="https://learn.microsoft.com/en-us/rest/api/storagemover/agents/update?tabs=HTTP">Agents - Update - REST API (Azure Storage Mover)</a></td>
      </tr>
      <tr>
          <td>HTTP status return code ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>Leverage HTTP Status</td>
          <td><a href="https://github.com/Microsoft/api-guidelines/blob/master/Guidelines.md#711-http-status-codes">Guidelines.md#711-http-status-codes</a></td>
      </tr>
      <tr>
          <td>Is using rate limiter system¬† ¬† ¬† ¬†</td>
          <td>?</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Is using cache system ¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>‚úÖ</td>
          <td><a href="https://github.com/Microsoft/api-guidelines/blob/master/Guidelines.md#75-standard-request-headers">Guidelines.md#75-standard-request-headers</a></td>
      </tr>
      <tr>
          <td>Is validate UserAgent ¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>üö´</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Is validate¬† Referrral¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>üö´</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td><strong>Request</strong></td>
          <td>¬†</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Whether complex parameters are put into Form Fields or a separate JSON Body</td>
          <td>Body</td>
          <td>Reference Agents - Create Or Update - REST API (Azure Storage Mover)</td>
      </tr>
      <tr>
          <td>Whether the subresource is a one-time query or an independent query ¬† ¬† ¬† ¬†</td>
          <td>?</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Paging parameter storage¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>?</td>
          <td>No conclusion</td>
      </tr>
      <tr>
          <td>Whether complex parameters are put into Form Fields or a separate JSON Body</td>
          <td>Page based</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Whether the subresource is a one-time query or an independent query ¬† ¬† ¬† ¬†</td>
          <td>Server</td>
          <td><a href="https://learn.microsoft.com/en-us/rest/api/storagemover/agents/create-or-update?tabs=HTTP">Agents - Create Or Update - REST API (Azure Storage Mover)</a></td>
      </tr>
      <tr>
          <td><strong>Response</strong></td>
          <td>¬†</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Model presentation types¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>Sginle</td>
          <td>Speculation</td>
      </tr>
      <tr>
          <td>How large models contain sub-model models ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>?</td>
          <td>Overly complex scenarios with no single conclusion</td>
      </tr>
      <tr>
          <td>Whether field returns are on-demand or grouped or unified</td>
          <td>?</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>field presentation format ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>Camel</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Error code¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>Use the list of custom error codes</td>
          <td>At least within their respective products</td>
      </tr>
      <tr>
          <td>Error format¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>Customization</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Time Zone ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>?</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>HATEOAS</td>
          <td>?</td>
          <td><a href="https://learn.microsoft.com/en-us/azure/architecture/best-practices/api-design#use-hateoas-to-enable-navigation-to-related-resources">api-design#use-hateoas-to-enable-navigation-to-related-resources</a></td>
      </tr>
  </tbody>
</table>
<p>The overall design style of Azure is more complex than the Github API, and there are multiple versions of the same product, making it a little less uniform.
It looks a little less uniform. It is also more difficult to have a single specification that binds all teams in this complex scenario.
We can see that the Azaure team is working on the Guidelines, and they are recently launching the vNext specification.</p>
<h3 id="my-personal-style">My personal style</h3>
<p>My personal style is basically inherited from the Github API style, with some minor adjustments to make it more suitable for small and medium-sized product development.
The reasons for my changes are explained in the notes, and the starting point for changes is: simplify / reduce ambiguity / consider the actual cost. If &ldquo;Note&rdquo; is marked in the notes, it follows the Github scheme and adds some ideas.</p>
<table>
  <thead>
      <tr>
          <th>Problem</th>
          <th>Choice</th>
          <th>Comment</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>URL</strong></td>
          <td>¬†</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Dos API path&rsquo;s prefix</td>
          <td>/apis</td>
          <td>We often have only one system, one domain name to host the API and Web Page</td>
      </tr>
      <tr>
          <td>Does the path contain the API version</td>
          <td>‚úÖ</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Does path contain a group</td>
          <td>‚úÖ</td>
          <td>Do a layer of business module split to isolate certain cooperation boundaries</td>
      </tr>
      <tr>
          <td>Whether path contains action</td>
          <td>Depends (include if HTTP Verb CRUD cannot be satisfied)</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Model ID form</td>
          <td>Readable Stable Identity</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Model singular or plural in URL</td>
          <td>Plural</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Is the resource one-level (tiled) or multi-level (nested)</td>
          <td>Multi-level + One-level</td>
          <td>Note: 80% of cases follow the model attribution, a few cases (commonly in search) use the first level</td>
      </tr>
      <tr>
          <td>How is search implemented, standalone API (/models/search) or list-based¬†/models/¬†API</td>
          <td>Uniform &gt; Standalone</td>
          <td>Low-cost implementation of some (early Github issues were also without /search interface)</td>
      </tr>
      <tr>
          <td>Does it have an Alias URL</td>
          <td>üö´</td>
          <td>Keep it simple.</td>
      </tr>
      <tr>
          <td>Does the model in the URL allow abbreviations (or refinements)</td>
          <td>‚úÖ</td>
          <td>Once the streamlining is done, it needs to be marked in the glossary</td>
      </tr>
      <tr>
          <td>Hyphenation of multiple words of the model in the URL</td>
          <td>-</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Whether to distinguish between Web API and Open API (non-browser oriented)</td>
          <td>üö´</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td><strong>Header</strong></td>
          <td>¬†</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Are all verbs using POST¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>üö´</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Is the Modify action POST or PATCH?</td>
          <td>PATCH</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>HTTP status return code ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>Leverage HTTP Status</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Is using rate limiter system¬† ¬† ¬† ¬†</td>
          <td>‚úÖ 429</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Is using cache system ¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>üö´</td>
          <td>Keep it simple, use dynamic data, remove caching capabilities</td>
      </tr>
      <tr>
          <td>Is validate UserAgent ¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>‚úÖ</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Is validate¬† Referrral¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>üö´</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td><strong>Request</strong></td>
          <td>¬†</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Whether complex parameters are put into Form Fields or a separate JSON Body</td>
          <td>Body</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Whether the subresource is a one-time query or an independent query ¬† ¬† ¬† ¬†</td>
          <td>one-time</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Paging parameter storage¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>URL Query</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Whether complex parameters are put into Form Fields or a separate JSON Body</td>
          <td>Page</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Whether the subresource is a one-time query or an independent query ¬† ¬† ¬† ¬†</td>
          <td>Client</td>
          <td>Reduce server-side costs and tolerate extreme case gaps</td>
      </tr>
      <tr>
          <td><strong>Response</strong></td>
          <td>¬†</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Model presentation types¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>Multi</td>
          <td>BO / VO / Tiny / Rich</td>
      </tr>
      <tr>
          <td>How large models contain sub-model models ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>Core Model + Multiple Linked Resource Queries</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Whether field returns are on-demand or grouped or unified</td>
          <td>Unified</td>
          <td>Tiny Model (optional) / Model (default) / Rich Model (optional)</td>
      </tr>
      <tr>
          <td>field presentation format ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>Snake</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Error code¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>None</td>
          <td>Note: Many scenarios require only message</td>
      </tr>
      <tr>
          <td>Error format¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>Uniform</td>
          <td>¬†</td>
      </tr>
      <tr>
          <td>Time Zone ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬†</td>
          <td>ISO 8601</td>
          <td>Use only one format, no longer support multiple options</td>
      </tr>
      <tr>
          <td>HATEOAS</td>
          <td>üö´</td>
          <td>¬†</td>
      </tr>
  </tbody>
</table>
<h2 id="off-topic---an-interesting-design-for-apple-music">Off-Topic - An Interesting Design for Apple Music</h2>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202304/apple-music.png" alt="Apple Music"  />


</p>
<p><small>image from Apple Music</small></p>
<p>I was recently using Apple Music and noticed the URL structure of its web page:</p>
<p><code>/cn/album/we-sing-we-dance-we-steal-things/277635758?l=en</code></p>
<p>Looking closely at this URL structure, I can see that the Path contains human-readable slug in three parts: <code>alumn/$(name)/$(id)</code> (which contains the ID).
A question immediately occurred to me: are the intermediate readable names machine-sensitive and purely geared towards natural humans?
So I tested a fabricated address: <code>/cn/album/foobar/277635758?l=en</code>.
Can you guess if the result is accessible before you try to access it?</p>
<p>This design paradigm is a bit more complex than my current common URL design specification. My specification requires that the resource locale be organized using a two-level slug, <code>$(type)/$(id)</code>.
Whereas Apple uses <code>$(type)/(type-id)/$(id)</code>, taking care of both readability and accuracy.</p>
<h2 id="off-topic---why-graphql-doesnt-work">Off-Topic - Why GraphQL Doesn&rsquo;t Work</h2>
<p><a href="https://graphql.org/">GraphQL</a> is a way to request APIs by using a custom query language, which has the advantage of providing a more flexible way to fetch data.
Compared to RESTful APIs that require a single request for all the data needed, GraphQL allows the client to explicitly specify the data needed, thus reducing unnecessary data transfer and processing.</p>
<p>However, GraphQL&rsquo;s over-flexibility is also one of its drawbacks. Since it does not have some specifications for modeling business scenarios like the REST API, developers need to think about data processing themselves.
developers need to think about how to handle the data themselves.
This can lead to unreasonable query requests that can put excessive pressure on the back-end database. In addition, GraphQL has relatively few implementations and documentation, which also requires more learning costs.</p>
<p>Therefore, while GraphQL can provide better results in some specific scenarios, it is not suitable for all API design needs.
In fact, some companies have even chosen to drop support for GraphQL, such as Github&rsquo;s <a href="https://github.blog/changelog/2022-08-18-deprecation-notice-graphql-for-packages/">some projects</a>.</p>
<h2 id="last">Last</h2>
<blockquote>
<p>Complexity is incremental</p>
<ul>
<li>John Ousterhout (<a href="https://web.stanford.edu/~ouster/cgi-bin/cs190-winter18/lecture.php?topic=complexity">via</a>Ôºâ</li>
</ul></blockquote>
<p><mark>There is no best style, only the best fit, but it is important to have style. &lt;/mark</p>
<p>Building a good rule requires not only a deep understanding of existing mechanisms, but also a thorough grasp of the business domain, and effective collaboration and communication within the team to promote and implement the rule.
Once established, however, rules can effectively reduce the complexity of the system, avoiding increasing complexity over time and as the business progresses, and reducing communication costs on the R&amp;D side.</p>
<p>It&rsquo;s a long-term investment, but one that will pay off in the long run. I hope those with a long-term view will take note of this article.</p>
<p>Key reference documents:</p>
<ul>
<li>[api-guidelines/Guidelines.md at master - microsoft/api-guidelines](<a href="https://github.com/Microsoft/api-guidelines/blob/master/">https://github.com/Microsoft/api-guidelines/blob/master/</a> Guidelines.md)</li>
<li><a href="https://docs.github.com/en/rest/overview/about-githubs-apis?apiVersion=2022-11-28">GitHub&rsquo;s APIs</a></li>
<li>[Web API design best practices - Azure Architecture Center | Microsoft Learn](<a href="https://learn.microsoft.com/en-us/azure/architecture/best-">https://learn.microsoft.com/en-us/azure/architecture/best-</a> practices/api-design)</li>
<li><a href="https://developer.aliyun.com/article/701810">Reflections on API Design Best Practices - Valley Park</a></li>
</ul>
]]></content:encoded>
    </item>
    <item>
      <title>From Toodledo To Obsidian Tasks - my GTD best practices</title>
      <link>https://en.blog.alswl.com/2023/02/gtd/</link>
      <pubDate>Sun, 26 Feb 2023 18:50:50 +0800</pubDate>
      <guid>https://en.blog.alswl.com/2023/02/gtd/</guid>
      <description>&lt;p&gt;I recently completed the switch from Toodledo to Obsidian Tasks (an Obsidian plugin), both of which are extremely
powerful time management tools. Although Toodledo was almost my favorite GTD software, the increasingly unstable service
has been bothering me. Coincidentally, Obsidian Tasks&amp;rsquo; ability to combine querying and knowledge base has produced a
1+1&amp;gt;2 effect. After trying it out, I decided to migrate to Obsidian Tasks.&lt;/p&gt;
&lt;p&gt;Giving up an old friend like Toodledo, which I have been working with for more than a decade, made me feel a little sad,
but the process also prompted me to summarize my attempts at time management and share some of my experiences.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>I recently completed the switch from Toodledo to Obsidian Tasks (an Obsidian plugin), both of which are extremely
powerful time management tools. Although Toodledo was almost my favorite GTD software, the increasingly unstable service
has been bothering me. Coincidentally, Obsidian Tasks&rsquo; ability to combine querying and knowledge base has produced a
1+1&gt;2 effect. After trying it out, I decided to migrate to Obsidian Tasks.</p>
<p>Giving up an old friend like Toodledo, which I have been working with for more than a decade, made me feel a little sad,
but the process also prompted me to summarize my attempts at time management and share some of my experiences.</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202302/clock.png" alt="time"  />


</p>
<p><small>Image frrom Pixelbay</small></p>
<h2 id="what-is-gtd">What is GTD?</h2>
<p>In this fast-paced modern life, we all encounter a large amount of tasks and information, and how to effectively manage
time and tasks has become a challenge for many people. During my school days, I also struggled with task management.
Starting from 2009, I tried to use tools such as [calendars](<a href="https://blog.alswl.com/2010/01/use-google-calendar-to-">https://blog.alswl.com/2010/01/use-google-calendar-to-</a>
manage-the-time/) and <a href="https://blog.alswl.com/2010/04/desktop-recording-tool-boogunote/">notes</a> to organize my tasks and
information, but the effect was not ideal. It wasn&rsquo;t until later that I came across <a href="https://doit.im/">DoIt.im</a> and
discovered David Allen&rsquo;s book, &ldquo;Getting Things Done&rdquo;, which brought me a new approach to task management - GTD. For
decades since then, I have been using this method to manage my time.</p>
<p>GTD is a personal time management method created by David Allen, aimed at helping people manage their time and tasks
more effectively, thereby improving work efficiency and productivity. The basic idea of this method is <mark>to break
down all tasks into specific actionable steps and organize them in a reliable system for follow-up and management&lt;/
mark&gt;. Through this method, people can more easily take control of their work and life, reduce stress and anxiety, and
thus complete tasks more efficiently with greater focus.</p>
<p>So how do we implement GTD? Here are the basic steps:</p>
<ol>
<li>Collect: Collect all tasks, ideas, plans, and to-do items, using various tools such as notebooks, mobile phones, and computers.</li>
<li>Organize: Review the to-do tasks, classify all tasks and actionable steps, and review past unfinished projects.
<ul>
<li>Categorize: Review the collected tasks and categorize all tasks and actionable steps, commonly including projects, contexts, and time, to better understand the priority and relevance of the tasks. If the task can be completed quickly (&lt;2m), do it immediately.</li>
<li>Review: Regularly review the tasks and actionable steps to ensure their progress and status are promptly followed up, to better control tasks and life, and thus complete tasks more efficiently.</li>
</ul>
</li>
<li>Execute: Focus on the current task, avoid distractions, and use time management and attention control techniques to improve efficiency.</li>
</ol>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202302/gtd-en.png" alt="gtd"  />


</p>
<p>Note: There may be slight differences in structure and external tools I organized. <mark>I merged categorizing and
reviewing into the organizing step</mark> because I found that organizing is essentially planning, and planning involves
reviewing the collected to-do items as well as ongoing and completed projects. Why not do them together in the
organizing step?</p>
<h2 id="online-gtd-services-i-have-used">Online GTD Services I Have Used</h2>
<p>I have used several online task management software, including Doit.im, Remember The Milk, OmniFocus and Toodledo. Below is my usage history and comparison of these software.</p>
<h3 id="doitim">Doit.im</h3>
<p>I started with <a href="http://doit.im/">Doit.im</a> when I first got into GTD. It is a domestic software that I really like. Doit.im supports basic GTD functions, provides clear task lists, classification, priority and other functions, as well as multiple review modes and multi-platform synchronization. However, I later gave it up because I found the more powerful Toodledo.</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202302/doit-im.png" alt="doit.im"  />


</p>
<p><small>Image from doit.im</small></p>
<h3 id="remember-the-milk">Remember The Milk</h3>
<p>When looking for the next management tool to use after Doit.im, I found <a href="http://www.rememberthemilk.com/">Remember The Milk</a> (RTM). RTM provides basic task management functions such as adding tasks, setting reminders and archiving tasks etc., and supports multi-platform synchronization so you can use it on multiple devices such as computers or phones.</p>
<p>However some people may not like RTM&rsquo;s user interface design because it looks outdated compared to modern designs. In addition some advanced features require payment which was difficult for me at the time since I was still a poor student so I quickly stopped using RTM.</p>
<h3 id="toodledo">Toodledo</h3>
<p>I learned about <a href="https://www.toodledo.com/">Toodledo</a> from <a href="https://xbeta.info/gtd-toodledo.htm">xbeta.info/gtd-toodledo.htm</a> (a famous website where users share their experiences with different softwares).</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202302/toodledo.png" alt="toodledo"  />


</p>
<p><small>Image from toodeldo.com</small></p>
<p>Soon after that on <a href="(http://www.productivelife.cn/)">Productive Life</a> ,  I found a very complete tutorial introducing advanced techniques in using Toodeldo especially how to use its Search module effectively . Unfortunately this website cannot be accessed anymore but we can get an idea of what Toodleo looked like back then through screenshots taken from other sources:</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202302/productive-life.png" alt="productive-life"  />


</p>
<p><small>Image frrom twitter.com/productivelife</small></p>
<p>Toodleodo quickly became my favorite task management tool due to its comprehensive functionality supporting task classification sorting filtering etc., while also providing various review modes and custom fields. Additionally,Todoedo supports multi-platform synchronization along with a powerful API making integration with other applications easy.</p>
<h3 id="omnifocus">OmniFocus</h3>
<p>Since Todoedo had slow access speeds without much improvement in product functionality over time,I briefly explored using<a href="(https://www.omnigroup.com/omnifocus/)">OmniFocus</a>, which is a professional Mac platform task management tool offering features such as project decomposition context etc.,and can be extended via AppleScript among others.OmniFocus supports multiple sync services including Omni Sync Server WebDAV FTP etc., allowing users to choose different services according to their needs.All data are stored locally so users can continue using the software even without internet connection.</p>
<p>After paying for it for some time,I realized <mark>that OmniFocu&rsquo;s search function could not compare with Todoedo&rsquo;s Search function </mark>,so it couldn&rsquo;t meet my needs.</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202302/omnifocus.png" alt="OmniFocus"  />


</p>
<p><small>Image frrom <a href="https://www.omnigroup.com/Omnifocus">www.omnigroup.com/Omnifocus</a></small></p>
<h3 id="other-tools-tried-out">Other Tools Tried Out</h3>
<p>I have also tried out some other tools including Trello Asana Basement Tower Teambition etc.,
but since they were designed mainly for team collaboration rather than personal use,it wasn&rsquo;t convenient enough for me.Additionally,the customized search feature of these softwares (at that time) was often weak unable to meet my requirements.In the end,I returned back into the arms of Todoedo until now.</p>
<h2 id="how-do-i-organize-my-daily-tasks">How do I organize my daily tasks?</h2>
<p>I think in the GTD system, the collection and processing stages are relatively mechanical and simple. The real test for
people is the <strong>organization</strong> stage:</p>
<ul>
<li>Classification: how to quickly review all tasks and classify them;</li>
<li>Next step: how to determine the priority of the next task.</li>
</ul>
<p>Below, I will share some of my personal concepts and operational methods.</p>
<h3 id="classification-means-quick-review">Classification means quick review</h3>
<p>In order to better organize tasks, we need to pay attention to important attributes of tasks, including <mark>Context (environment), Project, Status, and Due</mark>. Context determines what needs to be done in the current environment and serves as a simple filter. I divide Context into Computer/Work/Mobile. Project assigns tasks to different projects with longer cycles and strong relevance among its tasks. Status describes whether a task can be processed immediately (Next) or requires waiting (Waiting). Some recurring tasks are labeled Active. Due describes time-related attributes such as On-time delivery (On), before this time (Due), or optional completion if possible.</p>
<p>Other attributes such as Priority and Folder type also need consideration but are not most important.</p>
<p>To better manage my daily workloads, every morning I open <mark>four views: single view, subtask view, project-xxx view,and inbox view.</mark></p>
<ul>
<li><strong>Single View</strong> contains individual independent tasks that can be sorted by priority.</li>
<li><strong>Subtask View</strong> shows parent-child relationships between larger goals broken down into smaller achievable steps.</li>
<li><strong>Project-x View</strong> categorizes specific projects according to fixed templates consisting of several dozen related subtasks.</li>
<li><strong>Inbox View</strong> is where newly collected items go through initial classification process.</li>
</ul>
<h3 id="whats-next">What&rsquo;s next?</h3>
<p>The following filtering list helps identify which immediate actions should take place:</p>
<ul>
<li><strong>Top</strong>: High-priority task</li>
<li>Tasks due within three days that aren&rsquo;t recurring types require checking &amp; preparation</li>
<li>Tasks due tomorrow require immediate action</li>
<li>High + Next: high-priority task with actionable conditions already met</li>
<li>Timer isn&rsquo;t empty indicating it has started but may have been interrupted by other events</li>
<li>Waiting indicates cooperation needed from others; progress check required</li>
</ul>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202302/now.png" alt="toodledo-now"  />


</p>
<p>Tasks on this list are ranked based on their overall priority level combined with deadline dates &amp; execution status considerations. Every time you enter work mode after reviewing your lists above just select top few items from this filtered list for execution.</p>
<h2 id="former-king---toodledo">Former King - Toodledo</h2>
<p>I&rsquo;ve used it for over twelve years now paying eight years&rsquo; subscription fees while its product philosophy deeply influenced my own strategies for managing time effectively.I&rsquo;ll introduce some features/details about Toodledo that worked quite well:</p>
<h3 id="detailed-features">Detailed Features</h3>
<h4 id="recurring-task-functionality">Recurring Task Functionality</h4>
<p>Toodledo supports recurring task functionality allowing users set up repeating periods like daily / weekly / monthly etc., so when a completed item reappears automatically in your active list ready for further processing.This feature helps users manage routine activities more efficiently like regular meetings,daily email handling,daily reviews etc..</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202302/repeat-1.png" alt="repeat-1"  />


</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202302/repeat-2.png" alt="repeat-2"  />


</p>
<h4 id="rich-time-function-types">Rich Time Function Types</h4>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202302/toodledo-due.png" alt="Toodledo Due"  />


</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202302/toodledo-timer.png" alt="Toodledo Timer"  />


</p>
<h4 id="search-function">Search Function</h4>
<p>Search function provided by Toodledo is very powerful supporting complex logical queries(offers conditional combinations
of AND/OR searches).Users could search based on multiple criteria including name,label,date,priority etc..This feature
helps users organize their workload more efficiently.I was highly dependent upon this feature during organization phase
hence couldn&rsquo;t leave Toodledo at one point.</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202302/toodledo-search.png" alt="Toodledo Search"  />


</p>
<h3 id="tools-and-plugins-i-developed">Tools and Plugins I Developed</h3>
<p>Overall, I would still recommend Toodledo to everyone. I have developed multiple tools and plugins based on the API provided by Toodledo. Let me introduce them to you:</p>
<h4 id="buff-1-elegant-subscription-of-toodledo-calendar">Buff 1: Elegant Subscription of Toodledo Calendar</h4>
<p>Toodledo provides calendar subscription capability that displays tasks in various calendar software. However, the original information is very messy, does not consider task time, and also calculates time incorrectly. Therefore, I developed a web service called <a href="https://github.com/alswl/toodledo_calendar_filter">toodledo_calendar_filter</a>.</p>
<p>It can display Toodledo&rsquo;s tasks more friendly on the calendar system. Specifically, it can filter <a href="https://www.toodledo.com/info/help_ical.php">Toodledo&rsquo;s iCal</a> and only display tasks with due dates and durations. If you also have similar needs, you can use my online service directly (<a href="https://toodledo-calendar-filter.alswl.com">https://toodledo-calendar-filter.alswl.com</a>).</p>
<p>Before:</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202302/calendar-before.png" alt="calendaer-before"  />


</p>
<p>After:</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202302/calendar-after.png" alt="calendar-after"  />


</p>
<h4 id="buff-2-make-toodeldo-have-gmail-shortcut-keys">Buff 2: Make Toodeldo Have Gmail Shortcut Keys</h4>
<p>When using Toodeldo for task management, do you feel that the operation is cumbersome and mouse efficiency is low? Do you miss Gmail-style shortcut keys? If so, then my project [alswl/my-toodleodo] (<a href="https://github.com/alswl/my-toodleodo">https://github.com/alswl/my-toodleodo</a>) can help solve this problem.</p>
<p>It is a Greasemonkey script for Toodleodo that provides a series of Gmail-style shortcut keys so that you can quickly operate like using Gmail in Toodleodo including moving tasks (<code>j</code> / <code>k</code>), task operations (<code>x</code> marks completion , <code>enter</code> starts the task), switching task views (<code>g s</code> jumps to search), etc.. It runs stably on Chrome/Safari/Firefox browsers; if you want to improve your efficiency when using ToodeldoÔºåyou may try it out.</p>
<h4 id="buff-3-command-line-tool-go-toodeldo">Buff 3: Command Line Tool go-toodeldo</h4>
<p>In order to quickly collect tasksÔºåI once used a CLI tool ([wsargent/toodeldo] (<a href="https://github.com/wsargent/toodeldo">https://github.com/wsargent/toodeldo</a>)) on Github„ÄÇHoweverÔºåit was based on version 1 of API which has been announced by official seven or eight years ago will be offline soon„ÄÇSo I made my own small project called <a href="https://github.com/alswl/go-toodeldo">go-toodeldo </a>.</p>
<p>At firstÔºågo-toodeoldo only provided basic CLI functions„ÄÇLaterÔºåI gradually added complete SDK„ÄÅCLI full functionality even an interactive <mark>TUI application</mark> allowing users to conveniently use Toodeoldo in Terminal„ÄÇ</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202302/go-toodledo.png" alt="go-toodledo"  />


</p>
<p>Toodeoldo does not provide OpenAPI interface officiallyÔºõI generated a reverse-engineered copy of [go-TOODEOLDO/swagger.yaml] (HttpsÔºö// github .com / alswl / go-TOODEOLDO/blob/master/api/swagger.yaml)Ôºåif anyone else has development requirements for TOODEOLDO API Ôºåthey could directly use this API„ÄÇ</p>
<h3 id="leaving">Leaving</h3>
<p>RecentlyÔºåI have become increasingly disappointed with the stability of Toodeldo -the task management service I&rsquo;ve been using all along„ÄÇ
They[changed their new service provider]ÔºàHttpsÔºö// blog .tooleldo .com/hello-from-the-new-Tooleldo-team/)Ôºå
and there are more frequent occurrences of unstable services while new team‚Äôs product capabilities also raise some questions.
Therefore,I decided to start looking for better task management services„ÄÇ
Because Kindle stopping its services in China event makes me doubt about cloud services&rsquo; reliability„ÄÇ
Therefore,I started looking for some<mark>localized solutions</mark>that could be serviced through network disks(such as iCloud),
so as to better protect my data privacy.</p>
<h2 id="final-winner---obsidian-tasks">Final Winner - Obsidian Tasks</h2>
<p><a href="https://obsidian.md/">Obsidian</a> is a personal knowledge management (KMS) and note-taking application based on local files, which helps users organize, link and analyze their notes and ideas. It is a purely local software that can be synchronized across multiple devices using methods such as network disks/NAS.</p>
<p><a href="https://github.com/obsidian-tasks-group/obsidian-tasks">Obsidian Tasks</a> is a powerful Obsidian plugin that allows you to easily manage tasks and to-do items in Obsidian. This plugin can add tasks to your notes through simple syntax, automatically mark the status of tasks according to their completion status. You can use Obsidian Tasks to track personal tasks, work tasks, study tasks, etc. In addition, it also has some other features such as custom task styles, creating filters to find tasks, and automatically moving tasks based on their status. Obsidian + Obsidian Tasks are a perfect combination that can help you better manage your to-do list and improve your productivity.</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202302/obisidian-tasks.png" alt="Obsidian Tasks"  />


</p>
<p><small>Image from <a href="https://github.com/obsidian-tasks-group/obsidia">https://github.com/obsidian-tasks-group/obsidia</a></small></p>
<p>My personal KMS has been fully migrated from [Notion] (<a href="http://notion.com/)to">http://notion.com/)to</a> Obisidan with low migration costs using Obisidan Tasks. After learning about Obsidain Task for some time,I have smoothly transferred my previous usage patterns of &ldquo;organizing&quot;and &ldquo;next task&quot;to Obisidan Task.I will continue introducing how I efficiently use Obisidan Task in these two scenarios.</p>
<p>I organize my pending task in the following ways:</p>
<ul>
<li>Ordinary document task marked with <code>[ ]</code>, usually small scattered ones.</li>
<li>Special documents ending with <code>.todo.md</code> for overall project coordination.</li>
<li>Documents tagged with <code>#todo</code>, usually big issues where I split out several <code>Tasks</code> at the top after splitting off the <code>TODO</code> queue tag.</li>
</ul>
<p>Based on this organizational structure,I easily handle these two scenarios: <strong>organizing</strong>and <strong>next task</strong>:</p>
<h3 id="classification-means-quick-review-1">Classification means quick review</h3>
<p>Use several views<mark>to present the recorded tasks in multiple views</mark>, including:</p>
<ul>
<li>Today&rsquo;s perspective
<ul>
<li>non-repeated: one-time taskÔºåoften more important</li>
<li>repeatÔºörepetitive taskÔºåsuch as weekly meetings or appointmentsÔºåoften transactional</li>
</ul>
</li>
<li>Time perspective
<ul>
<li>Upcoming expiration dateÔºàwithin 7 daysÔºâ</li>
</ul>
</li>
<li>Single TasksÔºötasks scattered throughout daily affairs without being included in files ending with <code>.todo</code></li>
<li>ProjectÔºötasks arranged by project</li>
<li>Tagged with <code>#todo</code>, often requiring processing of an entire document</li>
</ul>
<p>These views allow you to classify your tasks better and quickly review them.By using these views,you can better manage your pending items,and improve your productivity.</p>
<p>This is my projects / View.todo.md`:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gu">## Today
</span></span></span><span class="line"><span class="cl"><span class="gu"></span>
</span></span><span class="line"><span class="cl"><span class="gs">**WIP**</span>
</span></span><span class="line"><span class="cl"><span class="s">```tasks
</span></span></span><span class="line"><span class="cl"><span class="s"></span>status.type is IN_PROGRESS
</span></span><span class="line"><span class="cl"><span class="s">```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gs">**HighÔºàPlanningÔºâ**</span>
</span></span><span class="line"><span class="cl"><span class="s">```tasks
</span></span></span><span class="line"><span class="cl"><span class="s"></span>not done
</span></span><span class="line"><span class="cl">priority is above medium
</span></span><span class="line"><span class="cl"><span class="s">```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gs">**None repetead due today**</span>
</span></span><span class="line"><span class="cl"><span class="s">```tasks
</span></span></span><span class="line"><span class="cl"><span class="s"></span>((not done) AND (due before in 1 day)) OR (done on today)
</span></span><span class="line"><span class="cl">is not recurring
</span></span><span class="line"><span class="cl">sort by priority
</span></span><span class="line"><span class="cl"><span class="s">```</span>
</span></span><span class="line"><span class="cl"><span class="gs">**Repeated due today**</span>
</span></span><span class="line"><span class="cl"><span class="s">```tasks
</span></span></span><span class="line"><span class="cl"><span class="s"></span>((not done) AND (due before in 1 day)) OR (done on today)
</span></span><span class="line"><span class="cl">is recurring
</span></span><span class="line"><span class="cl">sort by priority
</span></span><span class="line"><span class="cl"><span class="s">```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gs">**Over due before today**</span>
</span></span><span class="line"><span class="cl"><span class="s">```tasks
</span></span></span><span class="line"><span class="cl"><span class="s"></span>not done
</span></span><span class="line"><span class="cl">due before today
</span></span><span class="line"><span class="cl">sort by priority
</span></span><span class="line"><span class="cl"><span class="s">```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gs">**Today complete**</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s">```tasks
</span></span></span><span class="line"><span class="cl"><span class="s"></span>done
</span></span><span class="line"><span class="cl">done on today
</span></span><span class="line"><span class="cl"><span class="s">```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gu">## Future (no repeat)
</span></span></span><span class="line"><span class="cl"><span class="gu"></span>
</span></span><span class="line"><span class="cl"><span class="gs">**in 1 day**</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s">```tasks
</span></span></span><span class="line"><span class="cl"><span class="s"></span>not done
</span></span><span class="line"><span class="cl">due before in 1 day
</span></span><span class="line"><span class="cl">is not recurring
</span></span><span class="line"><span class="cl">sort by priority
</span></span><span class="line"><span class="cl">sort by due
</span></span><span class="line"><span class="cl"><span class="s">```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gs">**in 3 day**</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s">```tasks
</span></span></span><span class="line"><span class="cl"><span class="s"></span>not done
</span></span><span class="line"><span class="cl">due after in 1 day
</span></span><span class="line"><span class="cl">due before in 3 day
</span></span><span class="line"><span class="cl">is not recurring
</span></span><span class="line"><span class="cl">sort by priority
</span></span><span class="line"><span class="cl">sort by due
</span></span><span class="line"><span class="cl"><span class="s">```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gs">**in 7 day**</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s">```tasks
</span></span></span><span class="line"><span class="cl"><span class="s"></span>not done
</span></span><span class="line"><span class="cl">due after in 3 day
</span></span><span class="line"><span class="cl">due before in 7 day
</span></span><span class="line"><span class="cl">is not recurring
</span></span><span class="line"><span class="cl">sort by priority
</span></span><span class="line"><span class="cl">sort by due
</span></span><span class="line"><span class="cl"><span class="s">```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gu">## Singles Tasks
</span></span></span><span class="line"><span class="cl"><span class="gu"></span>
</span></span><span class="line"><span class="cl"><span class="gs">**in 7dÔºànon project x no repeateÔºâ**</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s">```tasks
</span></span></span><span class="line"><span class="cl"><span class="s"></span>not done
</span></span><span class="line"><span class="cl">status.type is not CANCELLED
</span></span><span class="line"><span class="cl">NOT (path includes .index)
</span></span><span class="line"><span class="cl">NOT (path includes .todo)
</span></span><span class="line"><span class="cl">NOT (path includes .notodo)
</span></span><span class="line"><span class="cl">due after in 7 days
</span></span><span class="line"><span class="cl">sort by priority, due
</span></span><span class="line"><span class="cl"><span class="s">```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gs">**none project x no due x no repeat**</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="s">```tasks
</span></span></span><span class="line"><span class="cl"><span class="s"></span>not done
</span></span><span class="line"><span class="cl">status.type is not CANCELLED
</span></span><span class="line"><span class="cl">NOT (path includes .index)
</span></span><span class="line"><span class="cl">NOT (path includes .todo)
</span></span><span class="line"><span class="cl">NOT (path includes .notodo)
</span></span><span class="line"><span class="cl">no due date
</span></span><span class="line"><span class="cl">sort by priority, due
</span></span><span class="line"><span class="cl"><span class="s">```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gu">## Projects
</span></span></span><span class="line"><span class="cl"><span class="gu"></span>
</span></span><span class="line"><span class="cl">TODO
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gu">## Help
</span></span></span><span class="line"><span class="cl"><span class="gu"></span><span class="k">
</span></span></span><span class="line"><span class="cl"><span class="k">&gt; </span><span class="ge">[Queries Syntax](https://obsidian-tasks-group.github.io/obsidian-tasks/queries/)
</span></span></span></code></pre></div><h3 id="what-is-the-next-task">What is the next task?</h3>
<p>In Obsidian&rsquo;s <a href="https://help.obsidian.md/Plugins/Daily+notes">Daily Note</a> plugin, set the template to <code>_templates/daily</code> so that you can have a daily to-do list that you can use anytime.</p>
<p>This is my Daily setup, divided into four sections: Today&rsquo;s due single tasks / Today&rsquo;s due repeating tasks (transactional and unimportant) / Today&rsquo;s completed tasks / Today&rsquo;s new tasks (usually Single).</p>
<p>This is my <code>_template/daily.md</code> file:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-markdown" data-lang="markdown"><span class="line"><span class="cl"><span class="gu">## TODO
</span></span></span><span class="line"><span class="cl"><span class="gu"></span>
</span></span><span class="line"><span class="cl"><span class="gs">**WIP**</span>
</span></span><span class="line"><span class="cl"><span class="s">```tasks
</span></span></span><span class="line"><span class="cl"><span class="s"></span>status.type is IN_PROGRESS
</span></span><span class="line"><span class="cl"><span class="s">```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gs">**New tasks**</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gs">**Tasks view - today**</span>
</span></span><span class="line"><span class="cl"><span class="s">```tasks
</span></span></span><span class="line"><span class="cl"><span class="s"></span>((not done) AND (due before {{date}})) OR ((not done) AND (due on {{date}})) OR (done on {{date}})
</span></span><span class="line"><span class="cl">is not recurring
</span></span><span class="line"><span class="cl">sort by priority, due
</span></span><span class="line"><span class="cl"><span class="s">```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gs">**Tasks view - today(repeated)**</span>
</span></span><span class="line"><span class="cl"><span class="s">```tasks
</span></span></span><span class="line"><span class="cl"><span class="s"></span>((not done) AND (due before {{date}})) OR ((not done) AND (due on {{date}})) OR (done on {{date}})
</span></span><span class="line"><span class="cl">is recurring
</span></span><span class="line"><span class="cl">sort by priority, due
</span></span><span class="line"><span class="cl"><span class="s">```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gs">**Over due date**</span>
</span></span><span class="line"><span class="cl"><span class="s">```tasks
</span></span></span><span class="line"><span class="cl"><span class="s"></span>not done
</span></span><span class="line"><span class="cl">due before {{date}}
</span></span><span class="line"><span class="cl">sort by priority, due
</span></span><span class="line"><span class="cl"><span class="s">```</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gs">**Projects**</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">YOURS
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="gs">**Tasks view - today done**</span>
</span></span><span class="line"><span class="cl"><span class="s">```tasks
</span></span></span><span class="line"><span class="cl"><span class="s"></span>done
</span></span><span class="line"><span class="cl">done on {{date}}
</span></span><span class="line"><span class="cl"><span class="s">```</span>
</span></span></code></pre></div><h3 id="what-are-the-drawbacks-of-obsidian-tasks">What are the drawbacks of Obsidian Tasks?</h3>
<p>Firstly, it should be noted that Obsidian Tasks is a plugin for Obsidian. If you have not used Obsidian before, it may take some time to get familiar with it. However, if you are already using Obsidian, the bidirectional linking feature of Obsidian Tasks will provide excellent support for GTD scenarios, which is both an advantage and a disadvantage.</p>
<p>Secondly, at present, Obsidian Tasks does not offer timer functionality. However, personally speaking, this is no longer important to me. With age and over ten years of GTD training under my belt, I no longer need tools to maintain focus. When working I am quite focused and do not get distracted frequently.</p>
<p>Finally, it should be noted that there are issues with Obsidian itself. As a tool based on local files only without online tools (although there are other cloud-based solutions), if you want an online service accessible from both your computer and phone then perhaps Obsidian Tasks may not be suitable for you. For me personally though I use iCloud storage as part of Apple&rsquo;s ecosystem so all my data is stored in iCloud Drive; I use the macOS application and iOS version of <a href="https://obsdian.md/download">Obsidian</a> which allows me to easily use the same Vault (i.e., knowledge base) between my MacBook and iPhone. Before launching either app though I make sure that syncing has completed first.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Time management is an unavoidable topic for modern workers but also one we often struggle with too. The methodology behind GTD provides us with an easy yet efficient way to manage our workloads allowing us <mark>to quickly end procrastination or distraction states</mark>and fully immerse ourselves in our work.</p>
<p>Tools are important but they cannot solve all problems alone; when managing time effectively what matters most is being clear about <mark>what your goals actually are</mark>. When you have a clear mission in mind it will constantly float around in your head meaning even without GTD tools managing things becomes easier.</p>
<p>I hope this article introducing the GTD method can help bring benefits into your work life allowing you to complete tasks more efficiently while still enjoying life&rsquo;s beauty too! Remember: time is limited so cherish every minute; seize every opportunity making your own life more wonderful!</p>
]]></content:encoded>
    </item>
    <item>
      <title>How to fix keyboard - from coding to electronics factory worker</title>
      <link>https://en.blog.alswl.com/2022/10/fix-keyboard/</link>
      <pubDate>Wed, 19 Oct 2022 10:51:01 +0800</pubDate>
      <guid>https://en.blog.alswl.com/2022/10/fix-keyboard/</guid>
      <description>&lt;p&gt;




&lt;img loading=&#34;lazy&#34; src=&#34;https://en.blog.alswl.com/images/202210/fu-tu-kang.png&#34; alt=&#34;fu-tu-kang&#34;  /&gt;


&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;In order to be well prepared, how can I successfully join an electronics factory after graduating at the age of 35?&lt;/p&gt;
&lt;p&gt;Learn from fixing keyboards(it&amp;rsquo;s a joke)&lt;/p&gt;&lt;/blockquote&gt;
&lt;h2 id=&#34;background&#34;&gt;Background&lt;/h2&gt;
&lt;p&gt;The keyboard I using is the ErgoDox, an ergonomically split keyboard. More details about ErgoDox can be found in my previous &lt;a href=&#34;https://www.zhihu.com/question/52088337/answer/141073759&#34;&gt;answer&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;




&lt;img loading=&#34;lazy&#34; src=&#34;https://en.blog.alswl.com/images/202210/keyboard-view.png&#34; alt=&#34;keyboard-view&#34;  /&gt;


&lt;/p&gt;
&lt;p&gt;(former keycap color scheme + hand rest).&lt;/p&gt;
&lt;p&gt;




&lt;img loading=&#34;lazy&#34; src=&#34;https://en.blog.alswl.com/images/202210/keyboard-view-2.png&#34; alt=&#34;keyboard-view-2&#34;  /&gt;


&lt;/p&gt;
&lt;p&gt;After seven or eight years of work, it has been into the water, into the coffee, but also into the soy milk, now finally a few keys are not flexible, pressed a sticky feeling, can not provide a smooth coding feel.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202210/fu-tu-kang.png" alt="fu-tu-kang"  />


</p>
<blockquote>
<p>In order to be well prepared, how can I successfully join an electronics factory after graduating at the age of 35?</p>
<p>Learn from fixing keyboards(it&rsquo;s a joke)</p></blockquote>
<h2 id="background">Background</h2>
<p>The keyboard I using is the ErgoDox, an ergonomically split keyboard. More details about ErgoDox can be found in my previous <a href="https://www.zhihu.com/question/52088337/answer/141073759">answer</a>.</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202210/keyboard-view.png" alt="keyboard-view"  />


</p>
<p>(former keycap color scheme + hand rest).</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202210/keyboard-view-2.png" alt="keyboard-view-2"  />


</p>
<p>After seven or eight years of work, it has been into the water, into the coffee, but also into the soy milk, now finally a few keys are not flexible, pressed a sticky feeling, can not provide a smooth coding feel.</p>
<p>After a few months of using a back up Filco, I finally made up my mind to get the ErgoDox fixed.</p>
<h2 id="prepare">Prepare</h2>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202210/prepare.png" alt="prepare"  />


</p>
<ul>
<li>Soldering Iron</li>
<li>Solder Sucker</li>
<li>Solder</li>
<li>Key Shaft</li>
<li>Seiko Screw Driver Kit</li>
<li>Key Puller</li>
<li>Cherry Key Switch Puller</li>
</ul>
<p>For those without soldering experience, you can learn how to soldering.</p>
<p><a href="https://www.bilibili.com/video/BV1xt4y157LM/">Â•≥ÁîüÈÉΩËÉΩÂ≠¶‰ºöÁöÑÈîÆÁõòÁÑäÊé•Êç¢ËΩ¥ÊïôÁ®ã_ÂìîÂì©ÂìîÂì©_bilibili</a></p>
<p><a href="https://www.bilibili.com/video/BV1Ui4y177kk/">ÁîµÁÉôÈìÅÁöÑÈîôËØØÂíåÊ≠£Á°Æ‰ΩøÁî®ÊñπÊ≥ï_ÂìîÂì©ÂìîÂì©_bilibili</a></p>
<h2 id="processing">Processing</h2>
<center><mark><b>Check which key shafts to replace, press one and listen to one</b></mark></center>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202210/step-1.png" alt="step-1"  />


</p>
<center><mark><b>Remove the shell</b></mark></center>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202210/step-2.png" alt="step-2"  />


</p>
<center><mark><b>Remove the corresponding keycaps (note that F J keycaps are different)</b></mark></center>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202210/step-3.png" alt="step-3"  />


</p>
<center><mark><b>Melt the solder and suck the melted solder away with a solder sucker</b></mark></center>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202210/step-4.png" alt="step-4"  />


</p>
<center><mark><b>With a key switch puller, remove it from the front, remember there is a soft clip, to up and down direction (i.e. cherry logo direction + opposite force)</b></mark></center>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202210/step-5.png" alt="step-5"  />


</p>
<center><mark><b>Look at the coffee and soy milk that went in</b></mark></center>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202210/step-6.png" alt="step-6"  />


</p>
<center><mark><b>Weld the new key shaft on</b></mark></center>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202210/step-7.png" alt="step-7"  />


</p>
<center><mark><b>Sucking away the debris spit out the look of the solder sucker</b></mark></center>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202210/step-8.png" alt="step-8"  />


</p>
<center><mark><b>Final assembly</b></mark></center>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202210/keyboard-final.png" alt="keyboard-final"  />


</p>
<h2 id="summary">Summary</h2>
<p>I have that feeling of typing smoothly again ~</p>
<p>Youthfulness is back~</p>
<p>Finally, I&rsquo;d like to share my ErgoDox Layout configuration:</p>
<ul>
<li><a href="https://link.zhihu.com/?target=https%3A//github.com/alswl/ergodox-firmware/blob/master/src/keyboard/ergodox/layout/alswl-layout.c">alswl/ergodox-firmware/blob/master/src/keyboard/ergodox/layout/alswl-layout.c</a> My layout configuration, Five layoutsÔºöNormal / Funtion Key / Number Pad / MediaKey / Arrow</li>
<li><a href="https://link.zhihu.com/?target=https%3A//github.com/alswl/ergodox-firmware/blob/master/src/main.c%23L127">alswl/ergodox-firmware/blob/master/src/main.c#L127</a> configuration for LED, lighting on to indicated the different layout</li>
<li><a href="https://link.zhihu.com/?target=https%3A//github.com/alswl/teensy_loader_cli">alswl/teensy_loader_cli</a><a href="https://link.zhihu.com/?target=https%3A//github.com/alswl/teensy_loader_cli">alswl/teensy_loader_cli</a> teensy loader cli works for macSO, the ofiicial binary not works when press the reset button</li>
</ul>
<p>If you get something out of it, give it a like.</p>
]]></content:encoded>
    </item>
    <item>
      <title>Self hosted online collaborative drawing platform Excalidraw</title>
      <link>https://en.blog.alswl.com/2022/10/self-hosted-excalidraw/</link>
      <pubDate>Mon, 17 Oct 2022 00:08:31 +0800</pubDate>
      <guid>https://en.blog.alswl.com/2022/10/self-hosted-excalidraw/</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;First of all, I&amp;rsquo;d like to thank my in-laws for taking the baby for summer vacation, so I can have a weekend to develop this system.&lt;/p&gt;
&lt;p&gt;Also thanks to my wife, I did my own thing for two days during the weekend and didn&amp;rsquo;t criticize me.&lt;/p&gt;
&lt;p&gt;Lastly, I would like to thank the company for the team building, providing a hotel to stay and spending a night to fix the Chinese handwriting.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<blockquote>
<p>First of all, I&rsquo;d like to thank my in-laws for taking the baby for summer vacation, so I can have a weekend to develop this system.</p>
<p>Also thanks to my wife, I did my own thing for two days during the weekend and didn&rsquo;t criticize me.</p>
<p>Lastly, I would like to thank the company for the team building, providing a hotel to stay and spending a night to fix the Chinese handwriting.</p>
<p>Note: This is the open source version of Excalidraw, thanks to the community</p></blockquote>
<h2 id="1-excalidraw">#1 Excalidraw</h2>
<blockquote>
<p>Introduce Excalidraw, product features</p></blockquote>
<p>What is Excalidraw, <mark>it&rsquo;s (probably) the most powerful online collaborative drawing tool</mark>, you can try it by visiting <a href="https://excalidraw.com/">Excalidraw</a>.</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202210/anatomy_of_an_azure_function.png" alt="anatomy_of_an_azure_function.png"  />


</p>
<p>If you did not want get a blank diagram, then you can also visit this public panel <a href="https://excalidraw.com/#room=e630a562422e6e9d94db,IXndkz3JfOSGrlswJRC83Q">Excalidraw</a> to join in the creation.</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202210/excalidraw-share-room.png" alt="excalidraw-share-room.png"  />


</p>
<p>Excalidraw works very well, I summarize a few points.</p>
<ul>
<li>Hand Writing style (Hand Writing) to avoid OCD, what a pixel difference, are gone lie flat in the end</li>
<li>No delay in online collaboration, ideal for communication and collaboration in the post-epidemic era</li>
<li>The design of the product is excellent: shortcuts, object connection sticking, selected files directly to the local storage and other details are there</li>
</ul>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202210/excalidraw-homepage.png" alt="excalidraw-homepage.png"  />


</p>
<p>After this product was promoted internally by our internal partners, we quickly fell in love with it and put a lot of diagrams on Excalidraw, but it also led to a new problem.</p>
<center><mark><b>Public SaaS services have data security risks</b></mark></center>
<center><mark><b> What to do? I'm going to self hosted it!</b></mark></center>
<h2 id="2-before-deploying-lets-understand-how-excalidraw-works">#2 Before deploying, let&rsquo;s understand how Excalidraw works</h2>
<p><strong>How Excalidraw works and how self hosted works</strong>Ôºö</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202210/excalidraw-arch.png" alt="excalidraw-arch.png"  />


</p>
<p>So what is the core difficulty of self hosted.</p>
<p>Solving the excalidraw-storage data storage problem, aka. replacing the Google Cloud Platform&rsquo;s firebase service.</p>
<h2 id="3-self-hosted-poc">#3 Self hosted PoC</h2>
<blockquote>
<p>If things don&rsquo;t work out, ask yourself</p>
<p>- Mencius</p>
<p>It is better to seek from Github than to seek from yourself.</p>
<p>- alswl</p></blockquote>
<p>Let&rsquo;s start by looking at Excalidraw&rsquo;s storage system.
Firebase is Google&rsquo;s Serverless service, formerly an independent company (and quite popular), but later acquired by GCP.</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202210/firebase.png" alt="firebase.png"  />


</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202210/firebase-features.png" alt="firebase-features.png"  />


</p>
<p>I started with the idea of replacing Firebase and found a community service <a href="https://supabase.com/">Supabase</a> (found a free SaaS service, amazing)</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202210/supabase.png" alt="supabase.png"  />


</p>
<p>However, after careful research, I found that Supabase&rsquo;s API is not compatible with firebase and <mark> cannot be simply replaced with </mark>.</p>
<p>Excalidraw also relies on Excalidraw+ to provide a paid service. Is there a simple and viable solution from the community? I found a bit of a solution within the community:</p>
<ul>
<li><a href="https://github.com/excalidraw/excalidraw/issues/1772">Self hosting Excalidraw - Umbrella issue ¬∑ Issue #1772 ¬∑ excalidraw/excalidraw</a></li>
<li><a href="https://github.com/excalidraw/excalidraw/discussions/3879">Collaboration mode - Self-hosting vs Collab on top of ¬∑ Discussion #3879 ¬∑ excalidraw/excalidraw (github.com)</a></li>
</ul>
<p>They gave a way (although it was later proven that there was still a crooked way).</p>
<ul>
<li><a href="https://gitlab.com/kiliandeca/excalidraw-fork">Kilian Decaderincourt / Excalidraw Fork ¬∑ GitLab</a> forked excalidraw</li>
<li><a href="https://gitlab.com/kiliandeca/excalidraw-storage-backend">Kilian Decaderincourt / excalidraw-storage-backend ¬∑ GitLab</a></li>
</ul>
<p>So I started reviewing their solution, opened the code and saw that I had the right idea (replacing several interfaces of firebase), using my own KV storage (Redis / MySQL / Mongo) to replace it.</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202210/jing-shen.png" alt="jing-shen.png"  />


</p>
<p>Attempted deployment and immediately ran into problems with:</p>
<center><mark><b> Dockerfile build failed </b></mark></center>
<center><mark><b> Versions too far behind upstream (2020 -> 2022)</b></mark></center>
<center><mark><b> Merged with Rebase Unable to follow Upstream</b></mark></center>
<p>What a coincidence that I&rsquo;m <mark><b>Frontend Intern // Community Patching Specialist // Kubernetes Cleaner // YAML Senior Specialist </b></mark>, specializing in these few things.</p>
<h2 id="4-lets-do-it">#4 Let&rsquo;s do it</h2>
<ul>
<li><a href="https://github.com/alswl/excalidraw-storage-backend">alswl/excalidraw-storage-backend: Excalidraw Backend</a>
<ul>
<li>build with Dockerfile in two stages <a href="https://github.com/alswl/excalidraw-storage-backend/commit/d841d734ab02659df370a6bdef3f1d8947696580%5D(https://github.com/alswl/excalidraw-storage-backend/commit/d841d734ab02659df370a6bdef3f1d8947696580)">https://github.com/alswl/excalidraw-storage-backend/commit/d841d734ab02659df370a6bdef3f1d8947696580](https://github.com/alswl/excalidraw-storage-backend/commit/d841d734ab02659df370a6bdef3f1d8947696580)</a></li>
<li>using Chinese mirror <a href="https://github.com/alswl/excalidraw-storage-backend/commit/30a6da9c87b367bb1fbde449f754923638545fa8">feat: china mirror ¬∑ alswl/excalidraw-storage-backend@30a6da9</a></li>
</ul>
</li>
<li><a href="https://github.com/alswl/excalidraw">alswl/excalidraw: Virtual whiteboard for sketching hand-drawn like diagrams</a>
<ul>
<li>fix, using http stroage instead of firebase</li>
<li><a href="https://github.com/alswl/excalidraw/pull/2">Feat/self host backend by alswl ¬∑ Pull Request #2 ¬∑ alswl/excalidraw</a></li>
</ul>
</li>
</ul>
<center><mark><b> Modification code architecture </b></mark></center>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202210/self-hosted-excalidraw.png" alt="self-hosted-excalidraw.png"  />


</p>
<h2 id="5-futureor-not">#5 Future(or not)</h2>
<p>Excalidraw is a free version of the SaaS service, <mark><b>Excalidraw+ is a paid version </b></mark>, what&rsquo;s the difference?</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202210/excalidraw-price.png" alt="excalidraw-price.png"  />


</p>
<p>To sum up.</p>
<ul>
<li>More reliable storage, integrated to cloud storage (e.g. iCloud / NAS)</li>
<li>User identification, connected to a common identity system</li>
<li>More personalized permissions control (password access, targeted sharing), tenant control, project group control</li>
<li>Library shared within the domain</li>
<li>Integration with other systems (Yuque, Dingtalk Documents, Lark, etc.)</li>
</ul>
<p>Or, just <mark><b>buy Excalidraw enterprise</b></mark> version!!! Less works, more enjoy.</p>
<h2 id="6-chinese-handwriting-optimization">#6 Chinese handwriting optimization</h2>
<p>One problem is that <mark><b> Chinese fonts are not handwritten </b></mark>, which is very incongruous. Let&rsquo;s see which fonts work first.</p>
<p>Chinese handwriting fonts supported by macOS:</p>
<ul>
<li><a href="https://support.apple.com/zh-cn/HT212587">https://support.apple.com/zh-cn/HT212587</a></li>
<li><a href="https://support.apple.com/zh-cn/HT212587">macOS Monterey ÈôÑÂ∏¶ÁöÑÂ≠ó‰Ωì - ÂÆòÊñπ Apple ÊîØÊåÅ (‰∏≠ÂõΩ)</a></li>
</ul>
<p>cursive family:</p>
<ul>
<li>PanziPen</li>
<li>LingWai</li>
<li>Hannotate</li>
</ul>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202210/hanzipen-sc.png" alt="hanzipen-sc.png"  />


</p>
<p>Windows Chinese support for handwriting is poor, you have to install Office to have more options: ÂçéÊñáË°åÊ•∑; ÊñπÊ≠£Ëàí‰Ωì (release in Office)</p>
<ul>
<li><a href="https://www.zhihu.com/question/22703287">https://www.zhihu.com/question/22703287</a></li>
<li><a href="https://www.zhihu.com/question/22703287">Windows Á≥ªÁªüÂÜÖÁΩÆÁöÑ‰∏≠ÊñáÂ≠ó‰Ωì‰∏∫‰ªÄ‰πàÂè™ÊúâÈÇ£Âá†ÁßçÔºü‰∏çÂ§öÂÜÖÁΩÆÂá†ÁßçÂ≠ó‰ΩìÂë¢Ôºü - Áü•‰πé (zhihu.com)</a></li>
<li><a href="https://zh.m.wikipedia.org/zh-hans/Microsoft_Windows%E5%AD%97%E5%9E%8B%E5%88%97%E8%A1%A8">https://zh.m.wikipedia.org/zh-hans/Microsoft_WindowsÂ≠óÂûãÂàóË°®</a></li>
</ul>
<p>If not, only the system&rsquo;s own italic KaiTi will work.</p>
<p>Finally, relying on my poor front-end level, I made a PoC and submitted a PR to the official: [feat: simple impl of multi font support, for chinese font by alswl - Pull Request #5604 - excalidraw/excalidraw] (<a href="https://github.com/excalidraw/excalidraw/pull/5604">https://github.com/excalidraw/excalidraw/pull/5604</a>)</p>
<p>Here is the final result.</p>
<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/202210/chinese-hand-writing.png" alt="chinese-hand-writing.png"  />


</p>
<hr />
<h2 id="update-2022-12">Update 2022-12</h2>
<p>A few users came to me to ask how to deploy it.
So based on the above solution, I provided a set of one-click pull-up services based on Docker Compose: with collaboration, Chinese font support.
See <a href="https://github.com/alswl/excalidraw-collaboration">alswl/excalidraw-collaboration</a>.</p>
]]></content:encoded>
    </item>
    <item>
      <title>Type system in Python</title>
      <link>https://en.blog.alswl.com/2020/06/type-safe-python/</link>
      <pubDate>Tue, 23 Jun 2020 17:54:00 +0800</pubDate>
      <guid>https://en.blog.alswl.com/2020/06/type-safe-python/</guid>
      <description>&lt;p&gt;




&lt;img loading=&#34;lazy&#34; src=&#34;https://en.blog.alswl.com/images/upload_dropbox/202006/wall.png&#34; alt=&#34;wall&#34;  /&gt;



&lt;small&gt;image from pixabay.com&lt;/small&gt;&lt;/p&gt;
&lt;p&gt;Static typing is becoming more and more popular.
Several languages born after 2010, Go, Rust, TypeScript, etc., have gone the static typing route.
Some of the previously popular dynamic languages (Python, PHP, JavaScript) are also actively introducing new language features (Type Hint, TypeScript) to enhance static typing.&lt;/p&gt;
&lt;p&gt;Having worked on larger projects in Python, I have experienced the difficulties that dynamic languages pose when projects get large:
The cost of code regression during the refactoring phase was unusually high, and much of the historical code was afraid to move.
Then the technology stack shifted to Java, and being embraced by the type system made people feel safe.&lt;/p&gt;</description>
      <content:encoded><![CDATA[<p>




<img loading="lazy" src="https://en.blog.alswl.com/img/upload_dropbox/202006/wall.png" alt="wall"  />



<small>image from pixabay.com</small></p>
<p>Static typing is becoming more and more popular.
Several languages born after 2010, Go, Rust, TypeScript, etc., have gone the static typing route.
Some of the previously popular dynamic languages (Python, PHP, JavaScript) are also actively introducing new language features (Type Hint, TypeScript) to enhance static typing.</p>
<p>Having worked on larger projects in Python, I have experienced the difficulties that dynamic languages pose when projects get large:
The cost of code regression during the refactoring phase was unusually high, and much of the historical code was afraid to move.
Then the technology stack shifted to Java, and being embraced by the type system made people feel safe.</p>
<p>In the last year, I have been working on a stability-oriented operation and maintenance system. Python was used at the beginning of the system selection.
I pushed Python 3.7 in the project and used Python&rsquo;s type system on a large scale to mitigate potential risks.</p>
<p>Going back to my roots, I spent some time learning about Python&rsquo;s design and implementation of the type system.
This article is a PEP proposal that describes how far Python has come with the type system.</p>
<!-- more -->
<h2 id="type-systems">Type Systems</h2>
<p>Before we talk about type systems, we need to clarify two concepts, dynamic languages and dynamic types.</p>
<p>A dynamic programming language is a program that can change its structure at runtime.
This structure can include functions, objects, variable types, and program structures.
Dynamic types are one type of Type System, i.e., programs that can modify variable types during runtime.
The other type is the static type: the variable type is determined at compile time and is not allowed to change at runtime.
Another division of the type system is strong and weak types, where strong types are instructions that forbid type mismatches and weak types vice versa.</p>
<p>The two concepts, dynamic languages and dynamic types, have different entry points.
Python is a dynamic language and a dynamically typed language, or a strongly typed dynamic type.
This article will focus on the type system of the Python language and will not cover dynamic language features.</p>
<h2 id="the-road-to-type-safety">The road to type safety</h2>
<p>There is an ongoing debate within the industry about which is more powerful: dynamic or static types.
Proponents of static types see advantages in three areas: performance, error discovery, and efficient refactoring.
Static types can significantly improve runtime efficiency by determining the concrete type at compile time;
The ability to detect errors at compile time, especially when projects get progressively larger;
The type system can help the IDE to prompt for efficient refactoring.
Proponents of dynamic typing argue that analyzing code is simpler, less error-prone, and faster to write.</p>
<p>Python developers have not failed to see this pain point.
A series of PEP proposals were created.
The type system was introduced to Python through syntax and feature enhancements while retaining the benefits of Python&rsquo;s dynamic type system.</p>
<p>Python proposed PEP 484 in 2014, followed by a refined version of PEP 483 (The Theory of Type Hints).
Its project implementation, the <a href="https://docs.python.org/3/library/typing.html">typing</a> module, was released in 3.5.
After several iterations of PEP 484, PEP 526, PEP 544, PEP 586, PEP 589, and PEP 591, Python&rsquo;s type system has become very rich.
It even includes relatively rare features like Structural Subtyping and Literal Typing.</p>
<h3 id="pep-483---core-concepts">PEP 483 - Core Concepts</h3>
<p>Released in December 2014, <a href="https://www.python.org/dev/peps/pep-0483/">PEP 483</a>
This is a concise version of the core concepts Guido wrote, making clear the direction, boundaries, do&rsquo;s and don&rsquo;ts of building a type system for Python.</p>
<p>PEP 483 does not talk about concrete engineering implementations, but rather outlines how the Python type system is presented to the public.
Define the Type/Class difference, the former being a syntactic analysis concept and the latter a runtime concept.
Under this definition, a Class is a Type, but a Type is not necessarily a Class.
For example, <code>Union[str, int]</code> is a Type but not a Class.</p>
<p>PEP 483 also introduces built-in base types: <code>Any</code> / <code>Unison</code> / <code>Optional</code> / <code>Tuple</code> / <code>Callable</code>, which support rich upstream variations.</p>
<p>The biggest criticism of the static type system is that it is not flexible enough, and the Go language does not implement generics yet.
PEP 483 introduces the use of Python Generic types in a generic
The form is as follows:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">S</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">longest</span><span class="p">(</span><span class="n">first</span><span class="p">:</span> <span class="n">S</span><span class="p">,</span> <span class="n">second</span><span class="p">:</span> <span class="n">S</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">S</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">first</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">first</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">second</span><span class="p">)</span> <span class="k">else</span> <span class="n">second</span>
</span></span></code></pre></div><p>Finally, PEP 483 also mentions some important minor features:</p>
<ul>
<li>Alias Alias</li>
<li>Farward Reference (use definition class in definition class method annotations), eg.: solves the problem of needing to reference a Node in a binary tree Node node</li>
<li>covariance contravariant</li>
<li>Use annotations to mark types</li>
<li>Transformation Cast</li>
</ul>
<p>The implementation of PEP 483 relies heavily on <a href="https://www.python.org/dev/peps/pep-3107/">PEP 3107 &ndash; Function Annotations</a>.
This proposal. PEP 3107 introduces the use of function annotations. For example, <code>func(a: a1, b: b1) -&gt; r1</code>This code, thewhere the descriptors after the colon are recorded in the <code>__annotations__</code> variable of func.</p>
<p>PEP 3107 shows the effect as follows, where you can clearly see that the function variables are stored:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">add</span><span class="o">.</span><span class="vm">__annotations__</span>
</span></span><span class="line"><span class="cl"><span class="c1"># {&#39;x&#39;: int, &#39;y&#39;: int, &#39;return&#39;: int}</span>
</span></span></code></pre></div><p>PS: Python now has Decorator decorators / Annotation annotations, where Annotation is also designed with the same name as Java&rsquo;s Annotation, a potpourri.</p>
<h3 id="pep-484---type-hints-core">PEP 484 - Type Hints Core</h3>
<p><a href="https://www.python.org/dev/peps/pep-0484/">PEP 484 &ndash; Type Hints</a>
A complete description of how the Python type system is designed, how it is used, and what the details are (typing modules), building on PEP 483</p>
<p>This proposal begins by stating:</p>
<blockquote>
<p>Python will remain a dynamically typed language, and the authors have no desire to ever make type hints mandatory,
even by convention.</p></blockquote>
<p>In one sentence, the proposal eliminates the possibility of Python evolving to a static system at the language level.</p>
<p>In addition to the features already explained in PEP 483, the proposal also appeals to me in the following ways:</p>
<ul>
<li>Allow adding type descriptions to already existing libraries via Stub Files. Specifically, the typed signature of Python code is described using the <code>.pyi</code> file corresponding to the Python file.
This scheme is similar to TS&rsquo;s <code>@types</code> file.</li>
<li>Allowing type overloading with <code>@overload</code> is a long time coming, and Python can actually (in a sense) support overloading.</li>
<li>Introduces typing implementation details, such as using abs (Abstract Base Class) to build interfaces for common types, including <code>Sized</code> / <code>Iterable</code> base interfaces.
Personally, I think this is actually quite a lot of work, and is a way to sort out the dependencies of existing classes.</li>
<li>Python backward (Python 2) compatible methods are introduced, and there are several strategies:
Using decorator (<code>@typehints(foo=str, returns=str)</code>), comments, Stub files, Docstring</li>
</ul>
<h3 id="pep-526---variables-are-also-arranged">PEP 526 - Variables are also arranged</h3>
<p><a href="https://www.python.org/dev/peps/pep-0526/">PEP 526 - Syntax for Variable Annotations</a>
The core proposal is to add Type Hints support to variables.</p>
<p>Similar to <code>function annotation</code>, it is also stored by annotation.
The difference is that instead of adding a <code>__annotations__</code> member to the instance, the annotations information for the variable is stored in the context variable <code>__annotations__</code>.
This is actually quite understandable: when a variable type is defined, the variable is not yet initialized.</p>
<p>I&rsquo;ll write a demo to demonstrate this:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>
</span></span><span class="line"><span class="cl"><span class="n">users</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># print(__annotations__)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># {&#39;users&#39;: typing.List[int]}</span>
</span></span></code></pre></div><p>As you can see, the above demo has the effect of creating a <code>users</code> in the context variable, but this <code>users</code> doesn&rsquo;t actually exist, it just defines the type.
If you run <code>print(users)</code> it will throw <code>NameError: name 'users' is not defined</code>.</p>
<p>It is clearer to look at the bytecode:</p>
<pre tabindex="0"><code> L.   1         0  SETUP_ANNOTATIONS

 L.   1         2  LOAD_CONST               0
                4  LOAD_CONST               (&#39;List&#39;,)
                6  IMPORT_NAME              typing
                8  IMPORT_FROM              List
               10  STORE_NAME               List
               12  POP_TOP

 L.   3        14  LOAD_NAME                List
               16  LOAD_NAME                int
               18  BINARY_SUBSCR
               20  LOAD_NAME                __annotations__
               22  LOAD_STR                 &#39;users&#39;
               24  STORE_SUBSCR
               26  LOAD_CONST               None
               28  RETURN_VALUE
</code></pre><p>As you can clearly see, instead of creating a variable named users, the <code>__annotations__</code> variable is used.
Note: Python stores variables using the opcode <code>STORE_NAME</code>.</p>
<p>PS: There are a number of rejected proposals in this proposal, which is quite interesting, and the community has come up with a lot of strange and clever ideas.
You can see the caution of the community decision, the difficulty of upgrading the stock system.</p>
<h3 id="pep-544---nominal-subtyping-vs-structural-subtyping">PEP 544 - Nominal Subtyping vs Structural Subtyping</h3>
<p>The type system discussed in PEP 484 is Nominal Subtyping.
This <a href="https://www.python.org/dev/peps/pep-0544/">PEP 544 &ndash; Protocols: Structural subtyping (static duck typing)</a>
This <a href="">PEP 544 &ndash; Protocols: Structural subtyping (static duck typing)</a> is proposed for Structural subtyping.If I had to translate it, I think it could be called named subtypes / isomorphic subtypes.
Note that some people also refer to Structural Subtyping as Duck Typing, but the two are not the same, see
<a href="https://en.wikipedia.org/wiki/Duck_typing#Structural_type_systems">Duck typing / Comparison with other type systems</a>.</p>
<p>Nominal Subtyping refers to matching types literally, while Structural Subtyping matches by structure (behavior).
For example, Go&rsquo;s Type is a Structural Subtyping implementation.</p>
<p>Here is a simple demo to demonstrate the latter:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Iterator</span><span class="p">,</span> <span class="n">Iterable</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">Bucket</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">collect</span><span class="p">(</span><span class="n">items</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">collect</span><span class="p">(</span><span class="n">Bucket</span><span class="p">())</span>  <span class="c1"># Passes type check</span>
</span></span></code></pre></div><p>The code defines the type Bucket and provides two class members. These two class members happen to be the definition of Interator.Then in practice, you can use Bucket instead of Iterable.</p>
<h3 id="pep-586--pep-589--pep-591-continuous-enhancement">PEP 586 / PEP 589 / PEP 591 Continuous enhancement</h3>
<p><a href="https://www.python.org/dev/peps/pep-0586/">PEP 586 &ndash; Literal Types</a>
The Python 3.8 implementation supports the use of literals as types.
For example <code>Literal[4]</code>, and for a more semantic example <code>Literal['GREEN']</code>.</p>
<p>My first thought was that this is very similar to Symbol in Scala, which is written as <code>Symbol(&quot;GREEN&quot;)</code>.
This feature is quite collegial and easy to write in the DSL.Scala officials have said that the Symbol feature may be removed in the future, so it is recommended to use constants instead.</p>
<p><a href="https://www.python.org/dev/peps/pep-0589/">PEP 589 &ndash; TypedDict: Type Hints for Dictionaries with a Fixed Set of Keys</a>
Add a Type of key to Dict, inheriting from <code>TypedDict</code>.</p>
<p><a href="https://www.python.org/dev/peps/pep-0591/">PEP 591 &ndash; Adding a final qualifier to typing</a>
Add the concepts of <code>final</code> / <code>Final</code>, the former is a decorator, the latter is an annotation that marks the class/function/variable as unmodifiable.</p>
<p>At this point, Python 3.8 has the type system features we need every day (not at runtime üòÇ).</p>
<h2 id="summary">Summary</h2>
<p>Unfortunately, the <code>typing</code> module is clearly marked in the documentation as:</p>
<blockquote>
<p>The Python runtime does not enforce function and variable type annotations. They can be used by third party tools
such as type checkers, IDEs, linters, etc.</p></blockquote>
<p>Namely, the Python runtime (Intercepter / Code Evaluator) does not support type decorators for functions and variables.
These decorators can only be checked by third-party tools, such as type checkers, IDEs, statics, and Linter.</p>
<p>This information illustrates the limitations of Python&rsquo;s attempts at type safety. All the restrictions, constraints, and limitations don&rsquo;t happen at runtime.
The only way to harvest engineering-above-board value from the type system is to use third-party tools.</p>
<p>It&rsquo;s true that the Python community is trying to move closer to a type system, but how far can this non-language level Runtime support go?
Python lacks a golden father, and its godfather Red Hat has limited resources to invest. Even the community hasn&rsquo;t finished switching from Python 2 to Python 3 yet, so why?
The input/output ratio is too low, the new features are not attractive enough, and there are too many alternatives.</p>
<p>On the other hand, look at the competition:
Dynamic languages are moving closer to static languages, and static languages are absorbing features from dynamic languages. For example, the REPL (Read-Eval-Print-Loop) in Java 14.
Kotlin / Scala and other languages Type Inference.
Perhaps this evolution is more acceptable to users.</p>
<h2 id="ÂèÇËÄÉ">ÂèÇËÄÉ</h2>
<ul>
<li><a href="https://docs.python.org/3/library/typing.html">typing ‚Äî Support for type hints ‚Äî Python 3.8.3 documentation</a></li>
<li><a href="https://www.python.org/dev/peps/pep-0483/#type-variables">PEP 483 &ndash; The Theory of Type Hints | Python.org</a></li>
<li><a href="https://www.python.org/dev/peps/pep-0484/#abstract">PEP 484 &ndash; Type Hints | Python.org</a></li>
<li><a href="https://www.bernat.tech/the-state-of-type-hints-in-python/">the state of type hints in Python</a></li>
</ul>
]]></content:encoded>
    </item>
  </channel>
</rss>
